(()=>{"use strict";var t={750:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GestureDecoder=void 0,e.GestureDecoder=class{constructor(t){this.cache=[],this.x=0,this.y=0,this.delta=0,t.addEventListener("pointerdown",this.handlePointerDown.bind(this)),t.addEventListener("pointermove",this.handlePointerMove.bind(this)),t.addEventListener("pointerup",this.handlePointerUp.bind(this)),t.addEventListener("pointercancel",this.handlePointerUp.bind(this)),t.addEventListener("pointerout",this.handlePointerUp.bind(this)),t.addEventListener("pointerleave",this.handlePointerUp.bind(this))}on(t,e){switch(t){case"dragstart":this.dragStartHandler=e;break;case"dragupdate":this.dragUpdateHandler=e;break;case"dragstop":this.dragStopHandler=e;break;case"zoomstart":this.zoomStartHandler=e;break;case"zoomupdate":this.zoomUpdateHandler=e;break;case"zoomstop":this.zoomStopHandler=e}}handlePointerDown(t){switch(this.cache.push(t),this.cache.length){case 1:this.startDrag();break;case 2:this.stopDrag(),this.startZoom();break;case 3:this.stopZoom()}}handlePointerMove(t){for(var e=0;e<this.cache.length;++e)if(this.cache[e].pointerId==t.pointerId){this.cache[e]=t;break}switch(this.cache.length){case 1:this.updateDrag();break;case 2:this.updateZoom()}}handlePointerUp(t){let e=!1;switch(this.cache.length){case 1:this.stopDrag();break;case 2:this.stopZoom(),e=!0;break;case 3:this.startZoom()}for(var i=0;i<this.cache.length;++i)if(this.cache[i].pointerId==t.pointerId){this.cache.splice(i,1);break}e&&this.startDrag()}startDrag(){this.x=this.cache[0].clientX,this.y=this.cache[0].clientY,null!=this.dragStartHandler&&this.dragStartHandler({x:this.cache[0].clientX-this.x,y:this.cache[0].clientY-this.y})}updateDrag(){null!=this.dragUpdateHandler&&this.dragUpdateHandler({x:this.cache[0].clientX-this.x,y:this.cache[0].clientY-this.y})}stopDrag(){null!=this.dragStopHandler&&this.dragStopHandler({x:this.cache[0].clientX-this.x,y:this.cache[0].clientY-this.y})}startZoom(){let t=this.cache[0].clientX-this.cache[1].clientX,e=this.cache[0].clientY-this.cache[1].clientY;if(this.delta=Math.sqrt(t*t+e*e),null!=this.zoomStartHandler){let t=(this.cache[0].clientX+this.cache[1].clientX)/2,e=(this.cache[0].clientY+this.cache[1].clientY)/2;this.zoomStartHandler({x:t,y:e,scale:1})}}updateZoom(){if(null!=this.zoomUpdateHandler){let t=(this.cache[0].clientX+this.cache[1].clientX)/2,e=(this.cache[0].clientY+this.cache[1].clientY)/2,i=this.cache[0].clientX-this.cache[1].clientX,h=this.cache[0].clientY-this.cache[1].clientY,r=Math.sqrt(i*i+h*h);this.zoomUpdateHandler({x:t,y:e,scale:r/this.delta})}}stopZoom(){if(null!=this.zoomStopHandler){let t=(this.cache[0].clientX+this.cache[1].clientX)/2,e=(this.cache[0].clientY+this.cache[1].clientY)/2,i=this.cache[0].clientX-this.cache[1].clientX,h=this.cache[0].clientY-this.cache[1].clientY,r=Math.sqrt(i*i+h*h);this.zoomStopHandler({x:t,y:e,scale:r/this.delta})}}}},233:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.setupFullviewQuad=e.compileProgram=e.compileShader=void 0,e.compileShader=function(t,e,i){const h=t.createShader(e);if(null==h)throw new Error(`Failed to create a shader of type: ${e}`);if(t.shaderSource(h,i),t.compileShader(h),!t.getShaderParameter(h,t.COMPILE_STATUS)){const e="Failed to compile shader:\n"+t.getShaderInfoLog(h);throw t.deleteShader(h),new Error(e)}return h},e.compileProgram=function(t,e,i){const h=t.createProgram();if(null==h)throw new Error("Failed to create a GL program");const r=t.createShader(t.VERTEX_SHADER);if(!r)throw t.deleteProgram(h),new Error("Failed to create vertex shader!");const s=t.createShader(t.FRAGMENT_SHADER);if(!s)throw t.deleteProgram(h),t.deleteShader(r),new Error("Failed to create fragment shader!");if(t.shaderSource(r,e),t.shaderSource(s,i),t.attachShader(h,r),t.attachShader(h,s),t.compileShader(r),t.compileShader(s),t.linkProgram(h),!t.getProgramParameter(h,t.LINK_STATUS)){let e="Failed to link shader program:";const i=t.getProgramInfoLog(h);i&&(e+="\n"+i);const a=t.getShaderInfoLog(r);a&&(e+="Vertex shader log:\n"+a);const n=t.getShaderInfoLog(s);throw n&&(e+="Fragment shader log:\n"+n),t.deleteShader(r),t.deleteShader(s),t.deleteProgram(h),new Error(e)}return t.deleteShader(r),t.deleteShader(s),h},e.setupFullviewQuad=function(t,e,i){let h;if(h="string"==typeof i?i:t.getAttribLocation(e,i),-1==h)throw new Error(`Attribute ${i} was not found in the provided program.`);const r=t.createBuffer();if(null==r)throw new Error("Failed to create a buffer.");const s=new Float32Array([-1,-1,-1,1,1,-1,1,1]);return t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW),t.vertexAttribPointer(h,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(h),r}},680:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.init_gpu_renderer=void 0;const h=i(233);class r{constructor(t,e,i){this.rect=new DOMRect(-1,-1,2,2),this.canvas=t,this.gl=t.getContext("webgl"),this.program=h.compileProgram(this.gl,e,i),h.setupFullviewQuad(this.gl,this.program,"aPos");const r=this.canvas.width/this.canvas.height;this.rect.width*=r,this.rect.x*=r,this.gl.useProgram(this.program),this.uPosLoc=this.gl.getUniformLocation(this.program,"uPos"),this.uDimsLoc=this.gl.getUniformLocation(this.program,"uDims"),this.uLimLoc=this.gl.getUniformLocation(this.program,"uLim"),this.uInsideColorLoc=this.gl.getUniformLocation(this.program,"uInsideColor")}resize(t,e){const i=t/e;this.rect.height*=e/this.canvas.height,this.rect.width=this.rect.height*i,this.canvas.width=t,this.canvas.height=e,this.gl.viewport(0,0,t,e),this.cachedConfig&&this.draw(this.cachedConfig)}pan(t,e){this.rect.x-=t/this.canvas.width*this.rect.width,this.rect.y+=e/this.canvas.height*this.rect.height,this.cachedConfig&&this.draw(this.cachedConfig)}zoom(t,e,i){this.rect.x+=t/this.canvas.width*(this.rect.width-this.rect.width*i),this.rect.y+=(1-e/this.canvas.height)*(this.rect.height-this.rect.height*i),this.rect.width*=i,this.rect.height*=i,this.cachedConfig&&this.draw(this.cachedConfig)}draw(t){this.gl.useProgram(this.program),this.gl.uniform2f(this.uPosLoc,this.centerX,this.centerY),this.gl.uniform2f(this.uDimsLoc,.5*this.rect.width,.5*this.rect.height),this.gl.uniform1i(this.uLimLoc,32),this.gl.uniform4f(this.uInsideColorLoc,0,0,0,1),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.cachedConfig=t}get centerX(){return this.rect.x+.5*this.rect.width}get centerY(){return this.rect.y+.5*this.rect.height}}e.init_gpu_renderer=function(t,e){return Promise.all([fetch("shaders/identity.vs",{mode:"same-origin"}).then((t=>t.text())),fetch(`shaders/${e}.fs`,{mode:"same-origin"}).then((t=>t.text()))]).then((([e,i])=>new r(t,e,i)))}},940:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t,e,h){this.width=i.DEFAULT_WIDTH,this.margin=i.DEFAULT_MARGIN,this.menu=t,this.button=e,null!=h&&(this.width=h.width||i.DEFAULT_WIDTH,this.margin=h.margin||i.DEFAULT_MARGIN),this.button.addEventListener("click",this.toggle.bind(this))}open(){this.menu.style.width=`${this.width}pt`,this.button.style.marginRight=`${this.width+this.margin}pt`}close(){this.menu.style.width="0",this.button.style.marginRight=`${this.margin}pt`}toggle(){this.menu.style.width===`${this.width}pt`?this.close():this.open()}}e.default=i,i.DEFAULT_WIDTH=300,i.DEFAULT_MARGIN=20}},e={};function i(h){var r=e[h];if(void 0!==r)return r.exports;var s=e[h]={exports:{}};return t[h](s,s.exports,i),s.exports}(()=>{const t=i(750),e=i(680),h=i(940);let r=null,s=0,a=0,n=0;function o(){r&&r.draw({})}function c(t){s==t.x&&a==t.y||!r||r.pan(t.x-s,t.y-a),s=t.x,a=t.y}function d(t){c(t),t.scale!=n&&r&&r.zoom(t.x,t.y,n/t.scale),n=t.scale}(()=>{const i=document.getElementById("canvas");i.width=window.innerWidth,i.height=window.innerHeight,e.init_gpu_renderer(i,"mandel").then((t=>{r=t,requestAnimationFrame(o)}));let h=new t.GestureDecoder(i);h.on("dragstart",(t=>{s=t.x,a=t.y})),h.on("dragupdate",c),h.on("dragstop",c),h.on("zoomstart",(t=>{s=t.x,a=t.y,n=t.scale})),h.on("zoomupdate",d),h.on("zoomstop",d),i.addEventListener("wheel",(t=>null==r?void 0:r.zoom(t.clientX,t.clientY,1+.001*t.deltaY))),window.addEventListener("resize",(()=>null==r?void 0:r.resize(window.innerWidth,window.innerHeight)))})(),window.onload=()=>{new h.default(document.getElementById("side-menu"),document.getElementById("toggle-menu"))}})()})();