(()=>{"use strict";var t={447:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ProceduralImageView=void 0;const i=new Uint8ClampedArray;e.ProceduralImageView=class{constructor(t,e,i,h=64,s=64){if(this.canvas=t,this.context=t.getContext("2d"),this.chunkWidth=h,this.chunkHeight=s,void 0===e){let t=this.canvas.width/this.canvas.height;this.viewport=new DOMRect(-.8-1.1*t,-1.1,2.2*t,2.2)}else this.viewport=e;i=i||window.navigator.hardwareConcurrency,this.freeWorkers=[],this.work=[],this.limit=30,this.offsetX=0,this.offsetY=0,this.cleanRect=null;for(var a=0;a<i;++a){let t=new Worker("./scripts/draw_worker.js"),e=new Uint8ClampedArray(h*s*4);((t,e,i)=>{t.onmessage=i=>{let h=new Uint8ClampedArray(i.data.pixels);if(i.data.limit==e.limit&&i.data.viewport.width==e.viewport.width&&i.data.viewport.height==e.viewport.height){let t=new ImageData(h,i.data.width,i.data.height);e.context.putImageData(t,i.data.pixelX+e.offsetX-i.data.offsetX,i.data.pixelY+e.offsetY-i.data.offsetY)}let s=e.work.pop();null!=s?(s.pixels=h.buffer,t.postMessage(s,[s.pixels])):(e.freeWorkers.push([t,h]),e.cleanRect=e.viewport)}})(t,this),this.freeWorkers.push([t,e])}}update(t,e){e=e||new DOMRect(0,0,this.canvas.width,this.canvas.height),this.limit!=t&&(this.clearWork(),this.limit=t);let h=e.width/this.chunkWidth,s=e.height/this.chunkHeight;null!=this.clearStyle&&(this.context.fillStyle=this.clearStyle);const a=this.chunkWidth/this.canvas.width*this.viewport.width,n=this.chunkHeight/this.canvas.height*this.viewport.height;for(var r=0;r<s;++r){const s=e.y+r*this.chunkHeight,d=this.viewport.y+(e.y+r*this.chunkHeight)/this.canvas.height*this.viewport.height;for(var o=0;o<h;++o){const h=e.x+o*this.chunkWidth,r=this.viewport.x+(e.x+o*this.chunkWidth)/this.canvas.width*this.viewport.width;this.queueWork({pixels:i,width:this.chunkWidth,height:this.chunkHeight,rect:new DOMRect(r,d,a,n),limit:t,pixelX:h,pixelY:s,viewport:DOMRect.fromRect(this.viewport),offsetX:this.offsetX,offsetY:this.offsetY})}}this.work.reverse()}reset(t){if(this.clearWork(),this.canvas.width>=this.canvas.height){let t=this.canvas.width/this.canvas.height;this.viewport=new DOMRect(-t,-1,2*t,2)}else{let t=this.canvas.height/this.canvas.height;this.viewport=new DOMRect(-1,-t,2,2*t)}this.update(t)}pan(t,e){this.clearWork();let i=t>=0?t:this.canvas.width+t,h=e>=0?e:this.canvas.height+e,s=[];if(this.viewport.x-=t/this.canvas.width*this.viewport.width,this.viewport.y-=e/this.canvas.height*this.viewport.height,this.offsetX+=t,this.offsetY+=e,s=[new DOMRect(0,0,i,h),new DOMRect(i,0,this.canvas.width-i,h),new DOMRect(0,h,i,this.canvas.height-h),new DOMRect(i,h,this.canvas.width-i,this.canvas.height-h)],t<0&&e<0){let i=this.context.getImageData(-t,-e,s[0].width,s[0].height);this.context.putImageData(i,0,0)}else if(t>=0&&e<0){let i=this.context.getImageData(0,-e,s[1].width,s[1].height);this.context.putImageData(i,t,0)}else if(t<0&&e>=0){let i=this.context.getImageData(-t,0,s[2].width,s[2].height);this.context.putImageData(i,0,e)}else if(t>=0&&e>=0){let i=this.context.getImageData(0,0,s[3].width,s[3].height);this.context.putImageData(i,t,e)}this.update(this.limit)}zoom(t,e,i){this.clearWork();let h=t/this.canvas.width,s=e/this.canvas.height,a=this.viewport.x+this.viewport.width*h,n=this.viewport.y+this.viewport.height*s;if(this.viewport.width*=i,this.viewport.height*=i,this.viewport.x=a-this.viewport.width*h,this.viewport.y=n-this.viewport.height*s,i>1){let t=1/i;this.context.drawImage(this.canvas,this.canvas.width*h-this.canvas.width*h*t,this.canvas.height*s-this.canvas.height*s*t,this.canvas.width*t,this.canvas.height*t)}else this.context.drawImage(this.canvas,this.canvas.width*h-this.canvas.width*h*i,this.canvas.height*s-this.canvas.height*s*i,this.canvas.width*i,this.canvas.height*i,0,0,this.canvas.width,this.canvas.height);this.update(this.limit)}resize(t,e){this.clearWork(),this.viewport.width*=t/this.canvas.width,this.viewport.height*=e/this.canvas.height,this.canvas.width=t,this.canvas.height=e,this.update(this.limit)}clearWork(){this.work.length=0}queueWork(t){let e=this.freeWorkers.pop();null!=e?(t.pixels=e[1].buffer,e[0].postMessage(t,[t.pixels])):this.work.push(t)}}},235:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.view=void 0;const h=i(447);let s=document.getElementById("coord-x"),a=document.getElementById("coord-y"),n=0,r=0,o=!1;function d(t,e){s.textContent=`X: ${t.toExponential(3)}`,a.textContent=`Y: ${e.toExponential(3)}`}let c=document.getElementById("canvas");c.width=window.innerWidth,c.height=window.innerHeight;let w=new h.ProceduralImageView(c);e.view=w,window.addEventListener("resize",(()=>w.resize(window.innerWidth,window.innerHeight))),c.addEventListener("pointerdown",(t=>{o=!0,n=t.clientX,r=t.clientY})),c.addEventListener("pointermove",(t=>{o&&(w.pan(Math.round(t.clientX-n),Math.round(t.clientY-r)),n=t.clientX,r=t.clientY)})),c.addEventListener("pointerup",(()=>o=!1)),c.addEventListener("pointerleave",(()=>o=!1)),c.addEventListener("pointercancel",(()=>o=!1)),c.addEventListener("wheel",(t=>{w.zoom(t.clientX,t.clientY,1+.001*t.deltaY)})),c.addEventListener("mousemove",(t=>{d(w.viewport.x+t.clientX/c.width*w.viewport.width,w.viewport.y+t.clientY/c.height*w.viewport.height)})),c.addEventListener("mouseleave",(()=>{d(w.viewport.x+.5*w.viewport.width,w.viewport.y+.5*w.viewport.height)})),w.resize(window.innerWidth,window.innerHeight),d(w.viewport.x+.5*w.viewport.width,w.viewport.y+.5*w.viewport.height)}},e={};function i(h){var s=e[h];if(void 0!==s)return s.exports;var a=e[h]={exports:{}};return t[h](a,a.exports,i),a.exports}(()=>{const t=i(235);let e=document.getElementById("limit"),h=Number(e.value);function s(e){e!==h&&(t.view.update(e),h=e)}e.addEventListener("input",(()=>{let t=Number(e.value),i=Number(e.min),h=Number(e.max);t<i?t=i:t>h&&(t=h),t>=i&&t<=h&&s(t)})),e.addEventListener("change",(()=>{let t=0,i=Number(e.min),h=Number(e.max);""===e.value&&(e.value="30"),t=Number(e.value),t<i?e.value=e.min:t>h&&(e.value=e.max),s(Number(e.value))}))})(),(()=>{const t=i(235);let e=document.getElementById("limit"),h=document.getElementById("side-menu"),s=document.getElementById("toggle-menu"),a=document.getElementById("toggle-menu-arrow");s.addEventListener("click",(function(){"240pt"===h.style.width?(h.style.width="0",s.style.marginRight="20pt",a.classList.remove("right"),a.classList.add("left")):(h.style.width="240pt",h.getBoundingClientRect().width,s.style.marginRight="260pt",a.classList.remove("left"),a.classList.add("right"))})),document.getElementById("redraw").onclick=()=>{t.view.update(Number(e.value))},document.getElementById("reset").onclick=()=>{t.view.reset(Number(e.value))}})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZWNobm9tdW5rLmdpdGh1Yi5pby8uL3NyYy9Qcm9jZWR1cmFsSW1hZ2VWaWV3LnRzIiwid2VicGFjazovL3RlY2hub211bmsuZ2l0aHViLmlvLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly90ZWNobm9tdW5rLmdpdGh1Yi5pby93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly90ZWNobm9tdW5rLmdpdGh1Yi5pby8uL3NyYy9udW1lcmljX2lucHV0LnRzIiwid2VicGFjazovL3RlY2hub211bmsuZ2l0aHViLmlvLy4vc3JjL3NpZGVfbWVudS50cyJdLCJuYW1lcyI6WyJQTEFDRUhPTERFUl9CVUZGRVIiLCJVaW50OENsYW1wZWRBcnJheSIsImNhbnZhcyIsInZpZXdwb3J0Iiwid29ya2VyQ291bnQiLCJjaHVua1dpZHRoIiwiY2h1bmtIZWlnaHQiLCJ0aGlzIiwiY29udGV4dCIsImdldENvbnRleHQiLCJyYXRpbyIsIndpZHRoIiwiaGVpZ2h0IiwiRE9NUmVjdCIsIndpbmRvdyIsIm5hdmlnYXRvciIsImhhcmR3YXJlQ29uY3VycmVuY3kiLCJmcmVlV29ya2VycyIsIndvcmsiLCJsaW1pdCIsIm9mZnNldFgiLCJvZmZzZXRZIiwiY2xlYW5SZWN0IiwiaSIsIndvcmtlciIsIldvcmtlciIsInBpeGVscyIsInZpZXciLCJpbmRleCIsIm9ubWVzc2FnZSIsIm1zZyIsImRhdGEiLCJpbWFnZSIsIkltYWdlRGF0YSIsInB1dEltYWdlRGF0YSIsInBpeGVsWCIsInBpeGVsWSIsInBvcCIsImJ1ZmZlciIsInBvc3RNZXNzYWdlIiwicHVzaCIsInJlY3QiLCJjbGVhcldvcmsiLCJjaHVua3NYIiwiY2h1bmtzWSIsImNsZWFyU3R5bGUiLCJmaWxsU3R5bGUiLCJyZWN0VyIsInJlY3RIIiwieSIsInJlY3RZIiwieCIsInJlY3RYIiwicXVldWVXb3JrIiwiZnJvbVJlY3QiLCJyZXZlcnNlIiwidXBkYXRlIiwibWlkWCIsIm1pZFkiLCJxdWFkcmFudHMiLCJpbWFnZURhdGEiLCJnZXRJbWFnZURhdGEiLCJzY2FsZSIsInJlbFgiLCJyZWxZIiwicG9pbnRYIiwicG9pbnRZIiwiaW52U2NhbGUiLCJkcmF3SW1hZ2UiLCJsZW5ndGgiLCJmcmVlIiwibGFiZWxYIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImxhYmVsWSIsIm1vdXNlWCIsIm1vdXNlWSIsImVuYWJsZVBhbiIsImRpc3BsYXlDb29yZGluYXRlcyIsInRleHRDb250ZW50IiwidG9FeHBvbmVudGlhbCIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsIlByb2NlZHVyYWxJbWFnZVZpZXciLCJhZGRFdmVudExpc3RlbmVyIiwicmVzaXplIiwiZXZlbnQiLCJjbGllbnRYIiwiY2xpZW50WSIsInBhbiIsIk1hdGgiLCJyb3VuZCIsInpvb20iLCJkZWx0YVkiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImRyYXduTGltaXQiLCJOdW1iZXIiLCJ2YWx1ZSIsInJlZHJhd0ltbWVkaWF0ZWx5IiwibWluIiwibWF4Iiwic2lkZU1lbnUiLCJ0b2dnbGVCdXR0b24iLCJhcnJvdyIsInN0eWxlIiwibWFyZ2luUmlnaHQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvbmNsaWNrIiwicmVzZXQiXSwibWFwcGluZ3MiOiJvSEFBQSxNQUFNQSxFQUFxQixJQUFJQyxrQkFLL0IsNEJBeUJDLFlBQ0NDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQXFCLEdBQ3JCQyxFQUFzQixJQU10QixHQUpBQyxLQUFLTCxPQUFTQSxFQUNkSyxLQUFLQyxRQUFVTixFQUFPTyxXQUFXLE1BQ2pDRixLQUFLRixXQUFhQSxFQUNsQkUsS0FBS0QsWUFBY0EsT0FDSyxJQUFkLEVBQTJCLENB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akRrRyxFQUFhRSxNQUFNQyxZQUFjLFFBQ2pDRixFQUFNRyxVQUFVQyxPQUFPLFFBQ3ZCSixFQUFNRyxVQUFVRSxJQUFJLGFBdUJyQjNDLFNBQVNDLGVBQWUsVUFBVzRDLFFBQVUsS0FDNUMsRUFBQTFGLEtBQUs2QixPQUFPK0MsT0FBT3BGLEVBQU1xRixTQUUxQmhDLFNBQVNDLGVBQWUsU0FBVTRDLFFBQVUsS0FDM0MsRUFBQTFGLEtBQUsyRixNQUFNZixPQUFPcEYsRUFBTXFGLFUiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUExBQ0VIT0xERVJfQlVGRkVSID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KCk7XHJcblxyXG4vKiogQSB2aWV3IG9mIGEgcHJvY2VkdXJhbCBpbWFnZSB0aGF0IGNhbiBiZSBwYW5uZWQgb3Igem9vbWVkLlxyXG4gKiBUYWtlcyBhIGNhbnZhcyBlbGVtZW50IHRvIGRyYXcgdGhlIGltYWdlIG9uLiBEb2VzIG5vdCBjYXB0dXJlIGlucHV0cywgb25seSBoYW5kbGVzIGRyYXdpbmcgdGhlIGFjdHVhbCBpbWFnZS4gXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUHJvY2VkdXJhbEltYWdlVmlldyB7XHJcblxyXG5cdGNsZWFyU3R5bGU/OiBzdHJpbmcgfCBDYW52YXNHcmFkaWVudCB8IENhbnZhc1BhdHRlcm47XHJcblx0dmlld3BvcnQ6IERPTVJlY3Q7XHJcblxyXG5cdHByaXZhdGUgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcclxuXHRwcml2YXRlIGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcclxuXHRwcml2YXRlIGNodW5rV2lkdGg6IG51bWJlcjtcclxuXHRwcml2YXRlIGNodW5rSGVpZ2h0OiBudW1iZXI7XHJcblxyXG5cdHByaXZhdGUgZnJlZVdvcmtlcnM6IEFycmF5PFtXb3JrZXIsIFVpbnQ4Q2xhbXBlZEFycmF5XT47XHJcblx0cHJpdmF0ZSB3b3JrOiBBcnJheTxEcmF3UmVnaW9uTWVzc2FnZT47XHJcblx0cHJpdmF0ZSBsaW1pdDogbnVtYmVyO1xyXG5cdHByaXZhdGUgb2Zmc2V0WDogbnVtYmVyO1xyXG5cdHByaXZhdGUgb2Zmc2V0WTogbnVtYmVyO1xyXG5cclxuXHRwcml2YXRlIGNsZWFuUmVjdDogRE9NUmVjdCB8IG51bGw7XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7SFRNTENhbnZhc0VsZW1lbnR9IGNhbnZhcyBUaGUgY2FudmFzIHRvIHVzZS5cclxuXHQgKiBAcGFyYW0ge0RPTVJlY3R9IHZpZXdwb3J0IFRoZSB2aWV3ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZS5cclxuXHQgKiBAcGFyYW0ge251bWJlcn0gd29ya2VyQ291bnQgTnVtYmVyIG9mIGJhY2tncm91bmQgd29ya2VycyB0byB1c2UuIE11c3QgYmUgYXQgbGVhc3QgMS5cclxuXHQgKiBAcGFyYW0ge251bWJlcn0gY2h1bmtXaWR0aCBXaWR0aCBvZiBhIHNpbmdsZSBjaHVuayBvZiB0aGUgcHJvY2Vzc2VkIGltYWdlIGluIHBpeGVscy5cclxuXHQgKiBAcGFyYW0ge251bWJlcn0gY2h1bmtIZWlnaHQgSGVpZ2h0IG9mIGEgc2luZ2xlIGNodW5rIG9mIHRoZSBwcm9jZXNzZWQgaW1hZ2UgaW4gcGl4ZWxzLlxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKFxyXG5cdFx0Y2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCxcclxuXHRcdHZpZXdwb3J0PzogRE9NUmVjdCxcclxuXHRcdHdvcmtlckNvdW50PzogbnVtYmVyLFxyXG5cdFx0Y2h1bmtXaWR0aDogbnVtYmVyID0gNjQsXHJcblx0XHRjaHVua0hlaWdodDogbnVtYmVyID0gNjQsXHJcblx0KSB7XHJcblx0XHR0aGlzLmNhbnZhcyA9IGNhbnZhcztcclxuXHRcdHRoaXMuY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpITtcclxuXHRcdHRoaXMuY2h1bmtXaWR0aCA9IGNodW5rV2lkdGg7XHJcblx0XHR0aGlzLmNodW5rSGVpZ2h0ID0gY2h1bmtIZWlnaHQ7XHJcblx0XHRpZiAodHlwZW9mKHZpZXdwb3J0KSA9PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHRcdC8vIERlZmF1bHQgdmlld3BvcnQgY2VudGVycyBhcm91bmQgLTEgYmVjYXVzZSB0aGUgbWFuZGVsYnJvdCBsb29rIGJldHRlciB0aGF0IHdheS5cclxuXHRcdFx0bGV0IHJhdGlvID0gdGhpcy5jYW52YXMud2lkdGggLyB0aGlzLmNhbnZhcy5oZWlnaHQ7XHJcblx0XHRcdHRoaXMudmlld3BvcnQgPSBuZXcgRE9NUmVjdCgtLjggLSAxLjEqcmF0aW8sIC0xLjEsIDIuMipyYXRpbywgMi4yKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMudmlld3BvcnQgPSB2aWV3cG9ydDtcclxuXHRcdH1cclxuXHRcdHdvcmtlckNvdW50ID0gd29ya2VyQ291bnQgfHwgd2luZG93Lm5hdmlnYXRvci5oYXJkd2FyZUNvbmN1cnJlbmN5O1xyXG5cdFx0dGhpcy5mcmVlV29ya2VycyA9IFtdO1xyXG5cdFx0dGhpcy53b3JrID0gW107XHJcblx0XHR0aGlzLmxpbWl0ID0gMzA7XHJcblx0XHR0aGlzLm9mZnNldFggPSAwO1xyXG5cdFx0dGhpcy5vZmZzZXRZID0gMDtcclxuXHRcdHRoaXMuY2xlYW5SZWN0ID0gbnVsbDtcclxuXHJcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHdvcmtlckNvdW50OyArK2kpIHtcclxuXHRcdFx0bGV0IHdvcmtlciA9IG5ldyBXb3JrZXIoJy4vc2NyaXB0cy9kcmF3X3dvcmtlci5qcycpO1xyXG5cdFx0XHRsZXQgcGl4ZWxzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGNodW5rV2lkdGggKiBjaHVua0hlaWdodCAqIDQpO1xyXG5cdFx0XHQvLy8gQ2FwdHVyZSBpbmRleFxyXG5cdFx0XHQoKHdvcmtlcjogV29ya2VyLCB2aWV3OiBQcm9jZWR1cmFsSW1hZ2VWaWV3LCBpbmRleDogbnVtYmVyKSA9PiB7XHJcblx0XHRcdFx0d29ya2VyLm9ubWVzc2FnZSA9IChtc2c6IE1lc3NhZ2VFdmVudDxEcmF3UmVnaW9uTWVzc2FnZT4pID0+IHtcclxuXHRcdFx0XHRcdGxldCBwaXhlbHMgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobXNnLmRhdGEucGl4ZWxzKTtcclxuXHRcdFx0XHRcdGlmIChtc2cuZGF0YS5saW1pdCA9PSB2aWV3LmxpbWl0XHJcblx0XHRcdFx0XHRcdCYmIG1zZy5kYXRhLnZpZXdwb3J0LndpZHRoID09IHZpZXcudmlld3BvcnQud2lkdGhcclxuXHRcdFx0XHRcdFx0JiYgbXNnLmRhdGEudmlld3BvcnQuaGVpZ2h0ID09IHZpZXcudmlld3BvcnQuaGVpZ2h0XHJcblx0XHRcdFx0XHQpIHtcclxuXHRcdFx0XHRcdFx0bGV0IGltYWdlID0gbmV3IEltYWdlRGF0YShwaXhlbHMsIG1zZy5kYXRhLndpZHRoLCBtc2cuZGF0YS5oZWlnaHQpO1xyXG5cdFx0XHRcdFx0XHR2aWV3LmNvbnRleHQucHV0SW1hZ2VEYXRhKFxyXG5cdFx0XHRcdFx0XHRcdGltYWdlLFxyXG5cdFx0XHRcdFx0XHRcdG1zZy5kYXRhLnBpeGVsWCArIHZpZXcub2Zmc2V0WCAtIG1zZy5kYXRhLm9mZnNldFgsXHJcblx0XHRcdFx0XHRcdFx0bXNnLmRhdGEucGl4ZWxZICsgdmlldy5vZmZzZXRZIC0gbXNnLmRhdGEub2Zmc2V0WSk7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0bGV0IHdvcmsgPSB2aWV3LndvcmsucG9wKCk7XHJcblx0XHRcdFx0XHRpZiAod29yayAhPSBudWxsKSB7XHJcblx0XHRcdFx0XHRcdHdvcmsucGl4ZWxzID0gcGl4ZWxzLmJ1ZmZlcjtcclxuXHRcdFx0XHRcdFx0d29ya2VyLnBvc3RNZXNzYWdlKHdvcmssIFt3b3JrLnBpeGVsc10pO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0dmlldy5mcmVlV29ya2Vycy5wdXNoKFt3b3JrZXIsIHBpeGVsc10pO1xyXG5cdFx0XHRcdFx0XHR2aWV3LmNsZWFuUmVjdCA9IHZpZXcudmlld3BvcnQ7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fTtcclxuXHRcdFx0fSkod29ya2VyLCB0aGlzLCBpKTtcclxuXHRcdFx0dGhpcy5mcmVlV29ya2Vycy5wdXNoKFt3b3JrZXIsIHBpeGVsc10pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqIFVwZGF0ZSBwYXJ0IG9mIHRoZSB2aWV3ZWQgaW1hZ2UuXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGxpbWl0IE1heGltdW0gbnVtYmVyIG9mIGl0ZXJhdGlvbnMgdG8gdXNlIHdoZW4gZHJhd2luZyB0aGUgaW1hZ2UuIFxyXG5cdCAqIEBwYXJhbSB7RE9NUmVjdH0gcmVjdCBUaGUgcmVnaW9uIG9mIHRoZSBpbWFnZSB0byByZWRyYXcgKGluIHBpeGVscykuIERlZmF1bHRzIHRvIHRoZSB3aG9sZSBpbWFnZSBpZiBudWxsLlxyXG5cdCAqL1xyXG5cdHVwZGF0ZShsaW1pdDogbnVtYmVyLCByZWN0PzogRE9NUmVjdCkge1xyXG5cdFx0cmVjdCA9IHJlY3QgfHwgbmV3IERPTVJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7XHJcblxyXG5cdFx0aWYgKHRoaXMubGltaXQgIT0gbGltaXQpIHtcclxuXHRcdFx0dGhpcy5jbGVhcldvcmsoKTtcclxuXHRcdFx0dGhpcy5saW1pdCA9IGxpbWl0O1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBjaHVua3NYID0gcmVjdC53aWR0aCAvIHRoaXMuY2h1bmtXaWR0aCxcclxuXHRcdFx0Y2h1bmtzWSA9IHJlY3QuaGVpZ2h0IC8gdGhpcy5jaHVua0hlaWdodDtcclxuXHJcblx0XHRpZiAodGhpcy5jbGVhclN0eWxlICE9IG51bGwpIHtcclxuXHRcdFx0dGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9IHRoaXMuY2xlYXJTdHlsZTtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCByZWN0VyA9IHRoaXMuY2h1bmtXaWR0aCAvIHRoaXMuY2FudmFzLndpZHRoICogdGhpcy52aWV3cG9ydC53aWR0aDtcclxuXHRcdGNvbnN0IHJlY3RIID0gdGhpcy5jaHVua0hlaWdodCAvIHRoaXMuY2FudmFzLmhlaWdodCAqIHRoaXMudmlld3BvcnQuaGVpZ2h0O1xyXG5cclxuXHRcdC8vIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAnZ3JlZW4nO1xyXG5cdFx0Zm9yICh2YXIgeSA9IDA7IHkgPCBjaHVua3NZOyArK3kpIHtcclxuXHRcdFx0Y29uc3QgcGl4ZWxZID0gcmVjdC55ICsgeSAqIHRoaXMuY2h1bmtIZWlnaHQ7XHJcblx0XHRcdGNvbnN0IHJlY3RZID0gdGhpcy52aWV3cG9ydC55ICsgKHJlY3QueSArIHkgKiB0aGlzLmNodW5rSGVpZ2h0KSAvIHRoaXMuY2FudmFzLmhlaWdodCAqIHRoaXMudmlld3BvcnQuaGVpZ2h0O1xyXG5cclxuXHRcdFx0Zm9yICh2YXIgeCA9IDA7IHggPCBjaHVua3NYOyArK3gpIHtcclxuXHRcdFx0XHRjb25zdCBwaXhlbFggPSByZWN0LnggKyB4ICogdGhpcy5jaHVua1dpZHRoO1xyXG5cdFx0XHRcdGNvbnN0IHJlY3RYID0gdGhpcy52aWV3cG9ydC54ICsgKHJlY3QueCArIHggKiB0aGlzLmNodW5rV2lkdGgpIC8gdGhpcy5jYW52YXMud2lkdGggKiB0aGlzLnZpZXdwb3J0LndpZHRoO1xyXG5cclxuXHRcdFx0XHQvLyB0aGlzLmNvbnRleHQuZmlsbFJlY3QocGl4ZWxYLCBwaXhlbFksIHRoaXMuY2h1bmtXaWR0aCwgdGhpcy5jaHVua0hlaWdodCk7XHJcblx0XHRcdFx0dGhpcy5xdWV1ZVdvcmsoe1xyXG5cdFx0XHRcdFx0cGl4ZWxzOiBQTEFDRUhPTERFUl9CVUZGRVIsXHJcblx0XHRcdFx0XHR3aWR0aDogdGhpcy5jaHVua1dpZHRoLFxyXG5cdFx0XHRcdFx0aGVpZ2h0OiB0aGlzLmNodW5rSGVpZ2h0LFxyXG5cdFx0XHRcdFx0cmVjdDogbmV3IERPTVJlY3QocmVjdFgsIHJlY3RZLCByZWN0VywgcmVjdEgpLFxyXG5cdFx0XHRcdFx0bGltaXQ6IGxpbWl0LFxyXG5cdFx0XHRcdFx0cGl4ZWxYOiBwaXhlbFgsXHJcblx0XHRcdFx0XHRwaXhlbFk6IHBpeGVsWSxcclxuXHRcdFx0XHRcdHZpZXdwb3J0OiBET01SZWN0LmZyb21SZWN0KHRoaXMudmlld3BvcnQpLFxyXG5cdFx0XHRcdFx0b2Zmc2V0WDogdGhpcy5vZmZzZXRYLFxyXG5cdFx0XHRcdFx0b2Zmc2V0WTogdGhpcy5vZmZzZXRZXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLndvcmsucmV2ZXJzZSgpO1xyXG5cdH1cclxuXHJcblx0LyoqIFJlc2V0IHRoZSB2aWV3cG9ydCB0byBkZWZhdWx0IHN0YXRlIGFuZCByZWRyYXcgdGhlIGltYWdlIHdpdGggcHJvdmlkZWQgbGltaXQuXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGxpbWl0IE1heGltdW0gbnVtYmVyIG9mIGl0ZXJhdGlvbnMgdG8gdXNlIHdoZW4gZHJhd2luZyB0aGUgaW1hZ2UuXHJcblx0ICovXHJcblx0cmVzZXQobGltaXQ6IG51bWJlcikge1xyXG5cdFx0dGhpcy5jbGVhcldvcmsoKTtcclxuXHRcdGlmICh0aGlzLmNhbnZhcy53aWR0aCA+PSB0aGlzLmNhbnZhcy5oZWlnaHQpIHtcclxuXHRcdFx0bGV0IHJhdGlvID0gdGhpcy5jYW52YXMud2lkdGggLyB0aGlzLmNhbnZhcy5oZWlnaHQ7XHJcblx0XHRcdHRoaXMudmlld3BvcnQgPSBuZXcgRE9NUmVjdCgtcmF0aW8sIC0xLCAyKnJhdGlvLCAyKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGxldCByYXRpbyA9IHRoaXMuY2FudmFzLmhlaWdodCAvIHRoaXMuY2FudmFzLmhlaWdodDtcclxuXHRcdFx0dGhpcy52aWV3cG9ydCA9IG5ldyBET01SZWN0KC0xLCAtcmF0aW8sIDIsIDIqcmF0aW8pO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy51cGRhdGUobGltaXQpO1xyXG5cdH1cclxuXHJcblx0LyoqIFNoaWZ0IHRoZWUgaW1hZ2UgcHJvdmlkZWQgbnVtYmVyIG9mIHBpeGVscy5cclxuXHQgKiBAcGFyYW0ge251bWJlcn0geCBIb3Jpem9udGFsIG51bWJlciBvZiBwaXhlbHMgdG8gc2hpZnQgdGhlIGltYWdlIGJ5LlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5IFZlcnRpY2FsIG51bWJlciBvZiBwaXhlbHMgdG8gc2hpZnQgdGhlIGltYWdlIGJ5LlxyXG5cdCAqL1xyXG5cdHBhbih4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG5cdFx0dGhpcy5jbGVhcldvcmsoKTtcclxuXHJcblx0XHRsZXQgbWlkWCA9IHggPj0gMCA/IHggOiB0aGlzLmNhbnZhcy53aWR0aCArIHgsXHJcblx0XHRcdG1pZFkgPSB5ID49IDAgPyB5IDogdGhpcy5jYW52YXMuaGVpZ2h0ICsgeSxcclxuXHRcdFx0cXVhZHJhbnRzOiBET01SZWN0W10gPSBbXTtcclxuXHRcdFxyXG5cdFx0dGhpcy52aWV3cG9ydC54IC09IHggLyB0aGlzLmNhbnZhcy53aWR0aCAqIHRoaXMudmlld3BvcnQud2lkdGg7XHJcblx0XHR0aGlzLnZpZXdwb3J0LnkgLT0geSAvIHRoaXMuY2FudmFzLmhlaWdodCAqIHRoaXMudmlld3BvcnQuaGVpZ2h0O1xyXG5cclxuXHRcdHRoaXMub2Zmc2V0WCArPSB4O1xyXG5cdFx0dGhpcy5vZmZzZXRZICs9IHk7XHJcblxyXG5cdFx0cXVhZHJhbnRzID0gW1xyXG5cdFx0XHRuZXcgRE9NUmVjdCgwLCAwLCBtaWRYLCBtaWRZKSxcclxuXHRcdFx0bmV3IERPTVJlY3QobWlkWCwgMCwgdGhpcy5jYW52YXMud2lkdGggLSBtaWRYLCBtaWRZKSxcclxuXHRcdFx0bmV3IERPTVJlY3QoMCwgbWlkWSwgbWlkWCwgdGhpcy5jYW52YXMuaGVpZ2h0IC0gbWlkWSksXHJcblx0XHRcdG5ldyBET01SZWN0KG1pZFgsIG1pZFksIHRoaXMuY2FudmFzLndpZHRoIC0gbWlkWCwgdGhpcy5jYW52YXMuaGVpZ2h0IC0gbWlkWSksXHJcblx0XHRdO1xyXG5cclxuXHRcdC8vIFJlbW92ZSB0aGUgY2xlYW4gcXVhZHJhbnQuXHJcblx0XHRpZiAoeCA8IDAgJiYgeSA8IDApIHtcclxuXHRcdFx0bGV0IGltYWdlRGF0YSA9IHRoaXMuY29udGV4dC5nZXRJbWFnZURhdGEoLXgsIC15LCBxdWFkcmFudHNbMF0ud2lkdGgsIHF1YWRyYW50c1swXS5oZWlnaHQpO1xyXG5cdFx0XHR0aGlzLmNvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XHJcblx0XHR9IGVsc2UgaWYgKHggPj0gMCAmJiB5IDwgMCkge1xyXG5cdFx0XHRsZXQgaW1hZ2VEYXRhID0gdGhpcy5jb250ZXh0LmdldEltYWdlRGF0YSgwLCAteSwgcXVhZHJhbnRzWzFdLndpZHRoLCBxdWFkcmFudHNbMV0uaGVpZ2h0KTtcclxuXHRcdFx0dGhpcy5jb250ZXh0LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIHgsIDApO1xyXG5cdFx0fSBlbHNlIGlmICh4IDwgMCAmJiB5ID49IDApIHtcclxuXHRcdFx0bGV0IGltYWdlRGF0YSA9IHRoaXMuY29udGV4dC5nZXRJbWFnZURhdGEoLXgsIDAsIHF1YWRyYW50c1syXS53aWR0aCwgcXVhZHJhbnRzWzJdLmhlaWdodCk7XHJcblx0XHRcdHRoaXMuY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCB5KTtcclxuXHRcdH0gZWxzZSBpZiAoeCA+PSAwICYmIHkgPj0gMCkge1xyXG5cdFx0XHRsZXQgaW1hZ2VEYXRhID0gdGhpcy5jb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCBxdWFkcmFudHNbM10ud2lkdGgsIHF1YWRyYW50c1szXS5oZWlnaHQpO1xyXG5cdFx0XHR0aGlzLmNvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgeCwgeSk7XHJcblx0XHR9XHJcblx0XHJcblx0XHR0aGlzLnVwZGF0ZSh0aGlzLmxpbWl0KTtcclxuXHR9XHJcblxyXG5cdC8qKiBab29tIHRoZSBpbWFnZSBpbiBvciBvdXQgYXJvdW5kIGEgcHJvdmlkZWQgcG9pbnQuXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHggVGhlIGhvcml6b250YWwgaW5kZXggb2YgdGhlIHBpeGVsIGFyb3VuZCB3aGljaCB0byB6b29tLlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5IFRoZSB2ZXJ0aWNhbCBpbmRleCBvZiB0aGUgcGl4ZWwgYXJvdW5kIHdoaWNoIHRvIHpvb20uXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHNjYWxlIFRoZSByYXRpbyBieSBob3cgbXVjaCB0byB6b29tIHRoZSBwaWN0dXJlLlxyXG5cdCAqL1xyXG5cdHpvb20oeDogbnVtYmVyLCB5OiBudW1iZXIsIHNjYWxlOiBudW1iZXIpIHtcclxuXHRcdHRoaXMuY2xlYXJXb3JrKCk7XHJcblxyXG5cdFx0bGV0IHJlbFggPSB4IC8gdGhpcy5jYW52YXMud2lkdGgsXHJcblx0XHRcdHJlbFkgPSB5IC8gdGhpcy5jYW52YXMuaGVpZ2h0LFxyXG5cdFx0XHRwb2ludFggPSB0aGlzLnZpZXdwb3J0LnggKyB0aGlzLnZpZXdwb3J0LndpZHRoICogcmVsWCxcclxuXHRcdFx0cG9pbnRZID0gdGhpcy52aWV3cG9ydC55ICsgdGhpcy52aWV3cG9ydC5oZWlnaHQgKiByZWxZO1xyXG5cdFx0XHJcblx0XHR0aGlzLnZpZXdwb3J0LndpZHRoICo9IHNjYWxlO1xyXG5cdFx0dGhpcy52aWV3cG9ydC5oZWlnaHQgKj0gc2NhbGU7XHJcblx0XHR0aGlzLnZpZXdwb3J0LnggPSBwb2ludFggLSB0aGlzLnZpZXdwb3J0LndpZHRoICogcmVsWDtcclxuXHRcdHRoaXMudmlld3BvcnQueSA9IHBvaW50WSAtIHRoaXMudmlld3BvcnQuaGVpZ2h0ICogcmVsWTtcclxuXHJcblx0XHQvLyBSZXVzZSB0aGUgZXhpc3RlbnQgaW1hZ2Ugd2hpbGUgdGhlIHdvcmtlcnMgYXJlIHJlZHJhd2luZyBpdC5cclxuXHRcdGlmIChzY2FsZSA+IDEpIHtcclxuXHRcdFx0bGV0IGludlNjYWxlID0gMSAvIHNjYWxlO1xyXG5cdFx0XHR0aGlzLmNvbnRleHQuZHJhd0ltYWdlKFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLndpZHRoICogcmVsWCAtIHRoaXMuY2FudmFzLndpZHRoICogcmVsWCAqIGludlNjYWxlLFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLmhlaWdodCAqIHJlbFkgLSB0aGlzLmNhbnZhcy5oZWlnaHQgKiByZWxZICogaW52U2NhbGUsXHJcblx0XHRcdFx0dGhpcy5jYW52YXMud2lkdGggKiBpbnZTY2FsZSxcclxuXHRcdFx0XHR0aGlzLmNhbnZhcy5oZWlnaHQgKiBpbnZTY2FsZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLmNvbnRleHQuZHJhd0ltYWdlKFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLndpZHRoICogcmVsWCAtIHRoaXMuY2FudmFzLndpZHRoICogcmVsWCAqIHNjYWxlLFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLmhlaWdodCAqIHJlbFkgLSB0aGlzLmNhbnZhcy5oZWlnaHQgKiByZWxZICogc2NhbGUsXHJcblx0XHRcdFx0dGhpcy5jYW52YXMud2lkdGggKiBzY2FsZSxcclxuXHRcdFx0XHR0aGlzLmNhbnZhcy5oZWlnaHQgKiBzY2FsZSxcclxuXHRcdFx0XHQwLFxyXG5cdFx0XHRcdDAsXHJcblx0XHRcdFx0dGhpcy5jYW52YXMud2lkdGgsXHJcblx0XHRcdFx0dGhpcy5jYW52YXMuaGVpZ2h0KTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnVwZGF0ZSh0aGlzLmxpbWl0KTtcclxuXHR9XHJcblxyXG5cdC8qKiBSZXNpemUgdGhlIHZpZXcuXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoIFRoZSBuZXcgd2lkdGggb2YgdGhlIHZpZXcgaW4gcGl4ZWxzLlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHQgVGhlIG5ldyBoZWlnaHQgb2YgdGhlIHZpZXcgaW4gcGl4ZWxzLlxyXG5cdCAqL1xyXG5cdHJlc2l6ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xyXG5cdFx0dGhpcy5jbGVhcldvcmsoKTtcclxuXHRcdHRoaXMudmlld3BvcnQud2lkdGggKj0gd2lkdGggLyB0aGlzLmNhbnZhcy53aWR0aDtcclxuXHRcdHRoaXMudmlld3BvcnQuaGVpZ2h0ICo9IGhlaWdodCAvIHRoaXMuY2FudmFzLmhlaWdodDtcclxuXHRcdHRoaXMuY2FudmFzLndpZHRoID0gd2lkdGg7XHJcblx0XHR0aGlzLmNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XHJcblx0XHR0aGlzLnVwZGF0ZSh0aGlzLmxpbWl0KTtcclxuXHR9XHJcblxyXG5cdC8qKiBDbGVhciBhbnkgcXVldWVkIHdvcmsgKi9cclxuXHRwcml2YXRlIGNsZWFyV29yaygpIHtcclxuXHRcdHRoaXMud29yay5sZW5ndGggPSAwO1xyXG5cdH1cclxuXHJcblx0LyoqIFF1ZXVlIGEgcGllY2Ugb2Ygd29yayB0byBiZSBkb25lLiAqL1xyXG5cdHByaXZhdGUgcXVldWVXb3JrKHdvcms6IERyYXdSZWdpb25NZXNzYWdlKSB7XHJcblx0XHRsZXQgZnJlZSA9IHRoaXMuZnJlZVdvcmtlcnMucG9wKCk7XHJcblx0XHRpZiAoZnJlZSAhPSBudWxsKSB7XHJcblx0XHRcdHdvcmsucGl4ZWxzID0gZnJlZVsxXS5idWZmZXI7XHJcblx0XHRcdGZyZWVbMF0ucG9zdE1lc3NhZ2Uod29yaywgW3dvcmsucGl4ZWxzXSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLndvcmsucHVzaCh3b3JrKTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIiwiaW1wb3J0IHsgUHJvY2VkdXJhbEltYWdlVmlldyB9IGZyb20gXCIuL1Byb2NlZHVyYWxJbWFnZVZpZXdcIjtcclxuXHJcbi8vIENvbnN0YW50c1xyXG5cclxuY29uc3QgV0hFRUxfU0VOU0lUSVZJVFkgPSAxZS0zO1xyXG5cclxuLy8gR2xvYmFsIHZhcmlhYmxlc1xyXG5cclxubGV0IGxhYmVsWCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb29yZC14JykgYXMgSFRNTEVsZW1lbnQsXHJcblx0bGFiZWxZID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nvb3JkLXknKSBhcyBIVE1MRWxlbWVudCxcclxuXHRtb3VzZVggPSAwLCBtb3VzZVkgPSAwLFxyXG5cdGVuYWJsZVBhbiA9IGZhbHNlO1xyXG5cclxuLy8gRnJlZSBmdW5jdGlvbiBkZWNsYXJhdGlvbnNcclxuXHJcbi8qKiBTZXQgdGhlIGNvb3JkaW5hdGVzIHRvIGRpc3BsYXkgcHJvdmlkZWQgdmFsdWVzLlxyXG4gKiBAcGFyYW0ge251bWJlcn0geCBUaGUgaG9yaXpvbnRhbCBjb29yZGluYXRlIHRvIGRpc3BsYXkuXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSB5IFRoZSB2ZXJ0aWNhbCBjb29yZGluYXRlIHRvIGRpc3BsYXkuXHJcbiAqL1xyXG5mdW5jdGlvbiBkaXNwbGF5Q29vcmRpbmF0ZXMoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuXHRsYWJlbFgudGV4dENvbnRlbnQgPSBgWDogJHt4LnRvRXhwb25lbnRpYWwoMyl9YDtcclxuXHRsYWJlbFkudGV4dENvbnRlbnQgPSBgWTogJHt5LnRvRXhwb25lbnRpYWwoMyl9YDtcclxufVxyXG5cclxubGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcclxuY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcbmNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcbmxldCB2aWV3ID0gbmV3IFByb2NlZHVyYWxJbWFnZVZpZXcoY2FudmFzKTtcclxuXHJcbi8vIFJlZ2lzdGVyIGV2ZW50c1xyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHZpZXcucmVzaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpKTtcclxuXHJcbmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIGV2ZW50ID0+IHtcclxuXHRlbmFibGVQYW4gPSB0cnVlO1xyXG5cdG1vdXNlWCA9IGV2ZW50LmNsaWVudFg7XHJcblx0bW91c2VZID0gZXZlbnQuY2xpZW50WTtcclxufSk7XHJcbmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIGV2ZW50ID0+IHtcclxuXHRpZiAoZW5hYmxlUGFuKSB7XHJcblx0XHR2aWV3LnBhbihNYXRoLnJvdW5kKGV2ZW50LmNsaWVudFggLSBtb3VzZVgpLCBNYXRoLnJvdW5kKGV2ZW50LmNsaWVudFkgLSBtb3VzZVkpKTtcclxuXHRcdG1vdXNlWCA9IGV2ZW50LmNsaWVudFg7XHJcblx0XHRtb3VzZVkgPSBldmVudC5jbGllbnRZO1xyXG5cdH1cclxufSk7XHJcbmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCAoKSA9PiBlbmFibGVQYW4gPSBmYWxzZSk7XHJcbmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybGVhdmUnLCAoKSA9PiBlbmFibGVQYW4gPSBmYWxzZSk7XHJcbmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyY2FuY2VsJywgKCkgPT4gZW5hYmxlUGFuID0gZmFsc2UpO1xyXG5cclxuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgZXZlbnQgPT4ge1xyXG5cdHZpZXcuem9vbShldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZLCAxICsgZXZlbnQuZGVsdGFZICogV0hFRUxfU0VOU0lUSVZJVFkpO1x0XHJcbn0pO1xyXG4vLyBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignZ2VzdHVyZWNoYW5nZScsIGV2ZW50ID0+IHtcclxuLy8gXHR2aWV3Lnpvb20oZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSwgZXZlbnQuc2NhbGUsIEdFU1RVUkVfU0NBTEVfREVMQVkpO1xyXG4vLyB9KTtcclxuLy8gY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2dlc3R1cmVlbmQnLCBldmVudCA9PiB7XHJcbi8vIFx0dmlldy56b29tKGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFksIGV2ZW50LnNjYWxlLCBHRVNUVVJFX1NDQUxFX0RFTEFZKTtcclxuLy8gfSk7XHJcblxyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgZXZlbnQgPT4ge1xyXG5cdGRpc3BsYXlDb29yZGluYXRlcyhcclxuXHRcdHZpZXcudmlld3BvcnQueCArIGV2ZW50LmNsaWVudFggLyBjYW52YXMud2lkdGggKiB2aWV3LnZpZXdwb3J0LndpZHRoLFxyXG5cdFx0dmlldy52aWV3cG9ydC55ICsgZXZlbnQuY2xpZW50WSAvIGNhbnZhcy5oZWlnaHQgKiB2aWV3LnZpZXdwb3J0LmhlaWdodCk7XHJcbn0pO1xyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcclxuXHRkaXNwbGF5Q29vcmRpbmF0ZXMoXHJcblx0XHR2aWV3LnZpZXdwb3J0LnggKyB2aWV3LnZpZXdwb3J0LndpZHRoKi41LFxyXG5cdFx0dmlldy52aWV3cG9ydC55ICsgdmlldy52aWV3cG9ydC5oZWlnaHQqLjUpO1xyXG59KTtcclxuXHJcbnZpZXcucmVzaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xyXG5cclxuZGlzcGxheUNvb3JkaW5hdGVzKFxyXG5cdHZpZXcudmlld3BvcnQueCArIHZpZXcudmlld3BvcnQud2lkdGgqLjUsXHJcblx0dmlldy52aWV3cG9ydC55ICsgdmlldy52aWV3cG9ydC5oZWlnaHQqLjUpO1xyXG5cclxuZXhwb3J0IHsgdmlldyB9O1xyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiaW1wb3J0IHsgdmlldyB9IGZyb20gXCIuL2NhbnZhc1wiO1xyXG5cclxuLy8gR2xvYmFsIHZhcmlhYmxlc1xyXG5cclxubGV0IGxpbWl0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbWl0JykgYXMgSFRNTElucHV0RWxlbWVudCxcclxuXHRyZWRyYXdUaW1lciA9IDAsXHJcblx0ZHJhd25MaW1pdCA9IE51bWJlcihsaW1pdC52YWx1ZSk7XHJcblxyXG4vLyBGcmVlIGZ1bmN0aW9uc1xyXG5cclxuLyoqIFJlZHJhdyB0aGUgcGljdHVyZSBpbW1lZGlhdGVseSBhbmQgY2FuY2VsIGFueSBwZW5kaW5nIHJlZHJhd3MuXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBsaW1pdCBUaGUgbGltaXQgdG8gdXNlIHdoZW4gcmVkcmF3aW5nLlxyXG4gKi9cclxuZnVuY3Rpb24gcmVkcmF3SW1tZWRpYXRlbHkobGltaXQ6IG51bWJlcik6IHZvaWQge1xyXG5cdGlmIChsaW1pdCAhPT0gZHJhd25MaW1pdCkge1xyXG5cdFx0dmlldy51cGRhdGUobGltaXQpO1xyXG5cdFx0ZHJhd25MaW1pdCA9IGxpbWl0O1xyXG5cdH1cclxufVxyXG5cclxuLy8gUmVnaXN0ZXIgZXZlbnQgbGlzdGVuZXJzXHJcblxyXG5saW1pdC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuXHRsZXQgdmFsdWUgPSBOdW1iZXIobGltaXQudmFsdWUpLFxyXG5cdFx0bWluID0gTnVtYmVyKGxpbWl0Lm1pbiksXHJcblx0XHRtYXggPSBOdW1iZXIobGltaXQubWF4KTtcclxuXHJcblx0aWYgKHZhbHVlIDwgbWluKSB7XHJcblx0XHR2YWx1ZSA9IG1pbjtcclxuXHR9IGVsc2UgaWYgKHZhbHVlID4gbWF4KSB7XHJcblx0XHR2YWx1ZSA9IG1heDtcclxuXHR9XHJcblxyXG5cdGlmICh2YWx1ZSA+PSBtaW4gJiYgdmFsdWUgPD0gbWF4KSB7XHJcblx0XHRyZWRyYXdJbW1lZGlhdGVseSh2YWx1ZSk7XHJcblx0fVxyXG59KTtcclxubGltaXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xyXG5cdGxldCB2YWx1ZSA9IDAsXHJcblx0bWluID0gTnVtYmVyKGxpbWl0Lm1pbiksXHJcblx0bWF4ID0gTnVtYmVyKGxpbWl0Lm1heCk7XHJcblx0XHJcblx0Ly8gVmFsaWRhdGUgaW5wdXRcclxuXHRpZiAobGltaXQudmFsdWUgPT09ICcnKSB7XHJcblx0XHRsaW1pdC52YWx1ZSA9ICczMCc7XHJcblx0fVxyXG5cdFxyXG5cdHZhbHVlID0gTnVtYmVyKGxpbWl0LnZhbHVlKTtcclxuXHJcblx0aWYgKHZhbHVlIDwgbWluKSB7XHJcblx0XHRsaW1pdC52YWx1ZSA9IGxpbWl0Lm1pbjtcclxuXHR9IGVsc2UgaWYgKHZhbHVlID4gbWF4KSB7XHJcblx0XHRsaW1pdC52YWx1ZSA9IGxpbWl0Lm1heDtcclxuXHR9XHJcblxyXG5cdHJlZHJhd0ltbWVkaWF0ZWx5KE51bWJlcihsaW1pdC52YWx1ZSkpO1xyXG59KTtcclxuIiwiaW1wb3J0IHsgdmlldyB9IGZyb20gXCIuL2NhbnZhc1wiO1xyXG5cclxuLy8gQ29uc3RhbnRzXHJcblxyXG5jb25zdCBNRU5VX1dJRFRIID0gMjQwO1xyXG5jb25zdCBUT0dHTEVfQlVUVE9OX01BUkdJTiA9IDIwO1xyXG5cclxuLy8gR2xvYmFsIHZhcmlhYmxlc1xyXG5cclxubGV0IGxpbWl0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbWl0JykgYXMgSFRNTElucHV0RWxlbWVudCxcclxuXHRzaWRlTWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaWRlLW1lbnUnKSEsXHJcblx0dG9nZ2xlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1tZW51JykhLFxyXG5cdGFycm93ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1tZW51LWFycm93JykhO1xyXG5cclxuLy8gRnJlZSBmdW5jdGlvbnNcclxuXHJcbi8qKiBPcGVuIHRoZSBzaWRlIG1lbnUgb2YgdGhlIGRvY3VtZW50LiAqL1xyXG5mdW5jdGlvbiBvcGVuU2lkZU1lbnUoKSB7XHJcblx0dmFyIHNpZGVNZW51V2lkdGggPSAwO1xyXG5cclxuXHRzaWRlTWVudS5zdHlsZS53aWR0aCA9IGAke01FTlVfV0lEVEh9cHRgO1xyXG5cdHNpZGVNZW51V2lkdGggPSBzaWRlTWVudS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDtcclxuXHR0b2dnbGVCdXR0b24uc3R5bGUubWFyZ2luUmlnaHQgPSBgJHtNRU5VX1dJRFRIICsgVE9HR0xFX0JVVFRPTl9NQVJHSU59cHRgO1xyXG5cdGFycm93LmNsYXNzTGlzdC5yZW1vdmUoJ2xlZnQnKTtcclxuXHRhcnJvdy5jbGFzc0xpc3QuYWRkKCdyaWdodCcpO1xyXG59XHJcblxyXG4vKiogQ2xvc2UgdGhlIHNpZGUgbWVudSBvZiB0aGUgZG9jdW1lbnQuICovXHJcbmZ1bmN0aW9uIGNsb3NlU2lkZU1lbnUoKSB7XHJcblx0c2lkZU1lbnUuc3R5bGUud2lkdGggPSAnMCc7XHJcblx0dG9nZ2xlQnV0dG9uLnN0eWxlLm1hcmdpblJpZ2h0ID0gYCR7VE9HR0xFX0JVVFRPTl9NQVJHSU59cHRgO1xyXG5cdGFycm93LmNsYXNzTGlzdC5yZW1vdmUoJ3JpZ2h0Jyk7XHJcblx0YXJyb3cuY2xhc3NMaXN0LmFkZCgnbGVmdCcpO1xyXG59XHJcblxyXG4vKiogT3BlbiB0aGUgc2lkZSBtZW51IG9mIHRoZSBkb2N1bWVudCBpZiBpdCdzIGNsb3NlZCBvciBjbG9zZSBpdCBpZiBpdCdzIG9wZW4uICovXHJcbmZ1bmN0aW9uIHRvZ2dsZVNpZGVNZW51KCkge1xyXG5cdGlmIChzaWRlTWVudS5zdHlsZS53aWR0aCA9PT0gYCR7TUVOVV9XSURUSH1wdGApIHtcclxuXHRcdGNsb3NlU2lkZU1lbnUoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0b3BlblNpZGVNZW51KCk7XHJcblx0fVxyXG59XHJcblxyXG4vLyBSZWdpc3RlciBldmVudHNcclxuXHJcbnRvZ2dsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVNpZGVNZW51KTtcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZHJhdycpIS5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdHZpZXcudXBkYXRlKE51bWJlcihsaW1pdC52YWx1ZSkpO1xyXG59XHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXNldCcpIS5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdHZpZXcucmVzZXQoTnVtYmVyKGxpbWl0LnZhbHVlKSk7XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==