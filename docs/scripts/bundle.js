(()=>{"use strict";var t={447:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ProceduralImageView=void 0;const i=new Uint8ClampedArray;e.ProceduralImageView=class{constructor(t,e,i,h=64,s=64){if(this.canvas=t,this.context=t.getContext("2d"),this.chunkWidth=h,this.chunkHeight=s,void 0===e){let t=this.canvas.width/this.canvas.height;this.viewport=new DOMRect(-.8-1.1*t,-1.1,2.2*t,2.2)}else this.viewport=e;i=i||window.navigator.hardwareConcurrency,this.freeWorkers=[],this.work=[],this.limit=30,this.offsetX=0,this.offsetY=0,this.cleanRect=null;for(var a=0;a<i;++a){let t=new Worker("./scripts/draw_worker.js"),e=new Uint8ClampedArray(h*s*4);((t,e,i)=>{t.onmessage=i=>{let h=new Uint8ClampedArray(i.data.pixels);if(i.data.limit==e.limit&&i.data.viewport.width==e.viewport.width&&i.data.viewport.height==e.viewport.height){let t=new ImageData(h,i.data.width,i.data.height);e.context.putImageData(t,i.data.pixelX+e.offsetX-i.data.offsetX,i.data.pixelY+e.offsetY-i.data.offsetY)}let s=e.work.pop();null!=s?(s.pixels=h.buffer,t.postMessage(s,[s.pixels])):(e.freeWorkers.push([t,h]),e.cleanRect=e.viewport)}})(t,this),this.freeWorkers.push([t,e])}}update(t,e){this.limit==t&&null!=e||this.clearWork(),e=e||new DOMRect(0,0,this.canvas.width,this.canvas.height),this.limit=t;let h=e.width/this.chunkWidth,s=e.height/this.chunkHeight;null!=this.clearStyle&&(this.context.fillStyle=this.clearStyle);const a=this.chunkWidth/this.canvas.width*this.viewport.width,n=this.chunkHeight/this.canvas.height*this.viewport.height;for(var r=0;r<s;++r){const s=e.y+r*this.chunkHeight,c=this.viewport.y+(e.y+r*this.chunkHeight)/this.canvas.height*this.viewport.height;for(var o=0;o<h;++o){const h=e.x+o*this.chunkWidth,r=this.viewport.x+(e.x+o*this.chunkWidth)/this.canvas.width*this.viewport.width;this.queueWork({pixels:i,width:this.chunkWidth,height:this.chunkHeight,rect:new DOMRect(r,c,a,n),limit:t,pixelX:h,pixelY:s,viewport:DOMRect.fromRect(this.viewport),offsetX:this.offsetX,offsetY:this.offsetY})}}this.work.reverse()}reset(t){if(this.clearWork(),this.canvas.width>=this.canvas.height){let t=this.canvas.width/this.canvas.height;this.viewport=new DOMRect(-t,-1,2*t,2)}else{let t=this.canvas.height/this.canvas.height;this.viewport=new DOMRect(-1,-t,2,2*t)}this.update(t)}pan(t,e){this.clearWork();let i=t>=0?t:this.canvas.width+t,h=e>=0?e:this.canvas.height+e,s=[];if(this.viewport.x-=t/this.canvas.width*this.viewport.width,this.viewport.y-=e/this.canvas.height*this.viewport.height,this.offsetX+=t,this.offsetY+=e,s=[new DOMRect(0,0,i,h),new DOMRect(i,0,this.canvas.width-i,h),new DOMRect(0,h,i,this.canvas.height-h),new DOMRect(i,h,this.canvas.width-i,this.canvas.height-h)],t<0&&e<0){let i=this.context.getImageData(-t,-e,s[0].width,s[0].height);this.context.putImageData(i,0,0)}else if(t>=0&&e<0){let i=this.context.getImageData(0,-e,s[1].width,s[1].height);this.context.putImageData(i,t,0)}else if(t<0&&e>=0){let i=this.context.getImageData(-t,0,s[2].width,s[2].height);this.context.putImageData(i,0,e)}else if(t>=0&&e>=0){let i=this.context.getImageData(0,0,s[3].width,s[3].height);this.context.putImageData(i,t,e)}this.update(this.limit)}zoom(t,e,i){this.clearWork();let h=t/this.canvas.width,s=e/this.canvas.height,a=this.viewport.x+this.viewport.width*h,n=this.viewport.y+this.viewport.height*s;if(this.viewport.width*=i,this.viewport.height*=i,this.viewport.x=a-this.viewport.width*h,this.viewport.y=n-this.viewport.height*s,i>1){let t=1/i;this.context.drawImage(this.canvas,this.canvas.width*h-this.canvas.width*h*t,this.canvas.height*s-this.canvas.height*s*t,this.canvas.width*t,this.canvas.height*t)}else this.context.drawImage(this.canvas,this.canvas.width*h-this.canvas.width*h*i,this.canvas.height*s-this.canvas.height*s*i,this.canvas.width*i,this.canvas.height*i,0,0,this.canvas.width,this.canvas.height);this.update(this.limit)}resize(t,e){this.clearWork(),this.viewport.width*=t/this.canvas.width,this.viewport.height*=e/this.canvas.height,this.canvas.width=t,this.canvas.height=e,this.update(this.limit)}clearWork(){this.work.length=0}queueWork(t){let e=this.freeWorkers.pop();null!=e?(t.pixels=e[1].buffer,e[0].postMessage(t,[t.pixels])):this.work.push(t)}}},235:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.view=void 0;const h=i(447);let s=document.getElementById("coord-x"),a=document.getElementById("coord-y"),n=0,r=0,o=!1;function c(t,e){s.textContent=`X: ${t.toExponential(3)}`,a.textContent=`Y: ${e.toExponential(3)}`}let d=document.getElementById("canvas");d.width=window.innerWidth,d.height=window.innerHeight;let l=new h.ProceduralImageView(d);e.view=l,window.addEventListener("resize",(()=>l.resize(window.innerWidth,window.innerHeight))),d.addEventListener("pointerdown",(t=>{o=!0,n=t.clientX,r=t.clientY})),d.addEventListener("pointermove",(t=>{o&&(l.pan(Math.round(t.clientX-n),Math.round(t.clientY-r)),n=t.clientX,r=t.clientY)})),d.addEventListener("pointerup",(()=>o=!1)),d.addEventListener("pointerleave",(()=>o=!1)),d.addEventListener("pointercancel",(()=>o=!1)),d.addEventListener("wheel",(t=>{l.zoom(t.clientX,t.clientY,1+.001*t.deltaY)})),d.addEventListener("gesturechange",(t=>{l.zoom(t.clientX,t.clientY,t.scale)})),d.addEventListener("gestureend",(t=>{l.zoom(t.clientX,t.clientY,t.scale)})),d.addEventListener("mousemove",(t=>{c(l.viewport.x+t.clientX/d.width*l.viewport.width,l.viewport.y+t.clientY/d.height*l.viewport.height)})),d.addEventListener("mouseleave",(()=>{c(l.viewport.x+.5*l.viewport.width,l.viewport.y+.5*l.viewport.height)})),l.resize(window.innerWidth,window.innerHeight),c(l.viewport.x+.5*l.viewport.width,l.viewport.y+.5*l.viewport.height)}},e={};function i(h){var s=e[h];if(void 0!==s)return s.exports;var a=e[h]={exports:{}};return t[h](a,a.exports,i),a.exports}(()=>{const t=i(235);let e=document.getElementById("limit"),h=Number(e.value);function s(e){e!==h&&(t.view.update(e),h=e)}e.addEventListener("input",(()=>{let t=Number(e.value),i=Number(e.min),h=Number(e.max);t<i?t=i:t>h&&(t=h),t>=i&&t<=h&&s(t)})),e.addEventListener("change",(()=>{let t=0,i=Number(e.min),h=Number(e.max);""===e.value&&(e.value="30"),t=Number(e.value),t<i?e.value=e.min:t>h&&(e.value=e.max),s(Number(e.value))}))})(),(()=>{const t=i(235);let e=document.getElementById("limit"),h=document.getElementById("side-menu"),s=document.getElementById("toggle-menu"),a=document.getElementById("toggle-menu-arrow");s.addEventListener("click",(function(){"240pt"===h.style.width?(h.style.width="0",s.style.marginRight="20pt",a.classList.remove("right"),a.classList.add("left")):(h.style.width="240pt",h.getBoundingClientRect().width,s.style.marginRight="260pt",a.classList.remove("left"),a.classList.add("right"))})),document.getElementById("redraw").onclick=()=>{t.view.update(Number(e.value))},document.getElementById("reset").onclick=()=>{t.view.reset(Number(e.value))}})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZWNobm9tdW5rLmdpdGh1Yi5pby8uL3NyYy9Qcm9jZWR1cmFsSW1hZ2VWaWV3LnRzIiwid2VicGFjazovL3RlY2hub211bmsuZ2l0aHViLmlvLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly90ZWNobm9tdW5rLmdpdGh1Yi5pby93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly90ZWNobm9tdW5rLmdpdGh1Yi5pby8uL3NyYy9udW1lcmljX2lucHV0LnRzIiwid2VicGFjazovL3RlY2hub211bmsuZ2l0aHViLmlvLy4vc3JjL3NpZGVfbWVudS50cyJdLCJuYW1lcyI6WyJQTEFDRUhPTERFUl9CVUZGRVIiLCJVaW50OENsYW1wZWRBcnJheSIsImNhbnZhcyIsInZpZXdwb3J0Iiwid29ya2VyQ291bnQiLCJjaHVua1dpZHRoIiwiY2h1bmtIZWlnaHQiLCJ0aGlzIiwiY29udGV4dCIsImdldENvbnRleHQiLCJyYXRpbyIsIndpZHRoIiwiaGVpZ2h0IiwiRE9NUmVjdCIsIndpbmRvdyIsIm5hdmlnYXRvciIsImhhcmR3YXJlQ29uY3VycmVuY3kiLCJmcmVlV29ya2VycyIsIndvcmsiLCJsaW1pdCIsIm9mZnNldFgiLCJvZmZzZXRZIiwiY2xlYW5SZWN0IiwiaSIsIndvcmtlciIsIldvcmtlciIsInBpeGVscyIsInZpZXciLCJpbmRleCIsIm9ubWVzc2FnZSIsIm1zZyIsImRhdGEiLCJpbWFnZSIsIkltYWdlRGF0YSIsInB1dEltYWdlRGF0YSIsInBpeGVsWCIsInBpeGVsWSIsInBvcCIsImJ1ZmZlciIsInBvc3RNZXNzYWdlIiwicHVzaCIsInJlY3QiLCJjbGVhcldvcmsiLCJjaHVua3NYIiwiY2h1bmtzWSIsImNsZWFyU3R5bGUiLCJmaWxsU3R5bGUiLCJyZWN0VyIsInJlY3RIIiwieSIsInJlY3RZIiwieCIsInJlY3RYIiwicXVldWVXb3JrIiwiZnJvbVJlY3QiLCJyZXZlcnNlIiwidXBkYXRlIiwibWlkWCIsIm1pZFkiLCJxdWFkcmFudHMiLCJpbWFnZURhdGEiLCJnZXRJbWFnZURhdGEiLCJzY2FsZSIsInJlbFgiLCJyZWxZIiwicG9pbnRYIiwicG9pbnRZIiwiaW52U2NhbGUiLCJkcmF3SW1hZ2UiLCJsZW5ndGgiLCJmcmVlIiwibGFiZWxYIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImxhYmVsWSIsIm1vdXNlWCIsIm1vdXNlWSIsImVuYWJsZVBhbiIsImRpc3BsYXlDb29yZGluYXRlcyIsInRleHRDb250ZW50IiwidG9FeHBvbmVudGlhbCIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsIlByb2NlZHVyYWxJbWFnZVZpZXciLCJhZGRFdmVudExpc3RlbmVyIiwicmVzaXplIiwiZXZlbnQiLCJjbGllbnRYIiwiY2xpZW50WSIsInBhbiIsIk1hdGgiLCJyb3VuZCIsInpvb20iLCJkZWx0YVkiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImRyYXduTGltaXQiLCJOdW1iZXIiLCJ2YWx1ZSIsInJlZHJhd0ltbWVkaWF0ZWx5IiwibWluIiwibWF4Iiwic2lkZU1lbnUiLCJ0b2dnbGVCdXR0b24iLCJhcnJvdyIsInN0eWxlIiwibWFyZ2luUmlnaHQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvbmNsaWNrIiwicmVzZXQiXSwibWFwcGluZ3MiOiJvSEFBQSxNQUFNQSxFQUFxQixJQUFJQyxrQkFLL0IsNEJBeUJDLFlBQ0NDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQXFCLEdBQ3JCQyxFQUFzQixJQU10QixHQUpBQyxLQUFLTCxPQUFTQSxFQUNkSyxLQUFLQyxRQUFVTixFQUFPTyxXQUFXLE1BQ2pDRixLQUFLRixXQUFhQSxFQUNsQkUsS0FBS0QsWUFBY0EsT0FDSyxJQUFkLEVBQTJCLENB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V0FDOEIsVUFBekJ3QixFQUFTRyxNQUFNcEcsT0FSbkJpRyxFQUFTRyxNQUFNcEcsTUFBUSxJQUN2QmtHLEVBQWFFLE1BQU1DLFlBQWMsT0FDakNGLEVBQU1HLFVBQVVDLE9BQU8sU0FDdkJKLEVBQU1HLFVBQVVFLElBQUksVUFacEJQLEVBQVNHLE1BQU1wRyxNQUFRLFFBQ1BpRyxFQUFTUSx3QkFBd0J6RyxNQUNqRGtHLEVBQWFFLE1BQU1DLFlBQWMsUUFDakNGLEVBQU1HLFVBQVVDLE9BQU8sUUFDdkJKLEVBQU1HLFVBQVVFLElBQUksYUF1QnJCM0MsU0FBU0MsZUFBZSxVQUFXNEMsUUFBVSxLQUM1QyxFQUFBMUYsS0FBSzZCLE9BQU8rQyxPQUFPcEYsRUFBTXFGLFNBRTFCaEMsU0FBU0MsZUFBZSxTQUFVNEMsUUFBVSxLQUMzQyxFQUFBMUYsS0FBSzJGLE1BQU1mLE9BQU9wRixFQUFNcUYsVSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBQTEFDRUhPTERFUl9CVUZGRVIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoKTtcclxuXHJcbi8qKiBBIHZpZXcgb2YgYSBwcm9jZWR1cmFsIGltYWdlIHRoYXQgY2FuIGJlIHBhbm5lZCBvciB6b29tZWQuXHJcbiAqIFRha2VzIGEgY2FudmFzIGVsZW1lbnQgdG8gZHJhdyB0aGUgaW1hZ2Ugb24uIERvZXMgbm90IGNhcHR1cmUgaW5wdXRzLCBvbmx5IGhhbmRsZXMgZHJhd2luZyB0aGUgYWN0dWFsIGltYWdlLiBcclxuICovXHJcbmV4cG9ydCBjbGFzcyBQcm9jZWR1cmFsSW1hZ2VWaWV3IHtcclxuXHJcblx0Y2xlYXJTdHlsZT86IHN0cmluZyB8IENhbnZhc0dyYWRpZW50IHwgQ2FudmFzUGF0dGVybjtcclxuXHR2aWV3cG9ydDogRE9NUmVjdDtcclxuXHJcblx0cHJpdmF0ZSBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xyXG5cdHByaXZhdGUgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cdHByaXZhdGUgY2h1bmtXaWR0aDogbnVtYmVyO1xyXG5cdHByaXZhdGUgY2h1bmtIZWlnaHQ6IG51bWJlcjtcclxuXHJcblx0cHJpdmF0ZSBmcmVlV29ya2VyczogQXJyYXk8W1dvcmtlciwgVWludDhDbGFtcGVkQXJyYXldPjtcclxuXHRwcml2YXRlIHdvcms6IEFycmF5PERyYXdSZWdpb25NZXNzYWdlPjtcclxuXHRwcml2YXRlIGxpbWl0OiBudW1iZXI7XHJcblx0cHJpdmF0ZSBvZmZzZXRYOiBudW1iZXI7XHJcblx0cHJpdmF0ZSBvZmZzZXRZOiBudW1iZXI7XHJcblxyXG5cdHByaXZhdGUgY2xlYW5SZWN0OiBET01SZWN0IHwgbnVsbDtcclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtIVE1MQ2FudmFzRWxlbWVudH0gY2FudmFzIFRoZSBjYW52YXMgdG8gdXNlLlxyXG5cdCAqIEBwYXJhbSB7RE9NUmVjdH0gdmlld3BvcnQgVGhlIHZpZXdlZCByZWdpb24gb2YgdGhlIGltYWdlLlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3b3JrZXJDb3VudCBOdW1iZXIgb2YgYmFja2dyb3VuZCB3b3JrZXJzIHRvIHVzZS4gTXVzdCBiZSBhdCBsZWFzdCAxLlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBjaHVua1dpZHRoIFdpZHRoIG9mIGEgc2luZ2xlIGNodW5rIG9mIHRoZSBwcm9jZXNzZWQgaW1hZ2UgaW4gcGl4ZWxzLlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBjaHVua0hlaWdodCBIZWlnaHQgb2YgYSBzaW5nbGUgY2h1bmsgb2YgdGhlIHByb2Nlc3NlZCBpbWFnZSBpbiBwaXhlbHMuXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IoXHJcblx0XHRjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50LFxyXG5cdFx0dmlld3BvcnQ/OiBET01SZWN0LFxyXG5cdFx0d29ya2VyQ291bnQ/OiBudW1iZXIsXHJcblx0XHRjaHVua1dpZHRoOiBudW1iZXIgPSA2NCxcclxuXHRcdGNodW5rSGVpZ2h0OiBudW1iZXIgPSA2NCxcclxuXHQpIHtcclxuXHRcdHRoaXMuY2FudmFzID0gY2FudmFzO1xyXG5cdFx0dGhpcy5jb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJykhO1xyXG5cdFx0dGhpcy5jaHVua1dpZHRoID0gY2h1bmtXaWR0aDtcclxuXHRcdHRoaXMuY2h1bmtIZWlnaHQgPSBjaHVua0hlaWdodDtcclxuXHRcdGlmICh0eXBlb2Yodmlld3BvcnQpID09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdFx0Ly8gRGVmYXVsdCB2aWV3cG9ydCBjZW50ZXJzIGFyb3VuZCAtMSBiZWNhdXNlIHRoZSBtYW5kZWxicm90IGxvb2sgYmV0dGVyIHRoYXQgd2F5LlxyXG5cdFx0XHRsZXQgcmF0aW8gPSB0aGlzLmNhbnZhcy53aWR0aCAvIHRoaXMuY2FudmFzLmhlaWdodDtcclxuXHRcdFx0dGhpcy52aWV3cG9ydCA9IG5ldyBET01SZWN0KC0uOCAtIDEuMSpyYXRpbywgLTEuMSwgMi4yKnJhdGlvLCAyLjIpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy52aWV3cG9ydCA9IHZpZXdwb3J0O1xyXG5cdFx0fVxyXG5cdFx0d29ya2VyQ291bnQgPSB3b3JrZXJDb3VudCB8fCB3aW5kb3cubmF2aWdhdG9yLmhhcmR3YXJlQ29uY3VycmVuY3k7XHJcblx0XHR0aGlzLmZyZWVXb3JrZXJzID0gW107XHJcblx0XHR0aGlzLndvcmsgPSBbXTtcclxuXHRcdHRoaXMubGltaXQgPSAzMDtcclxuXHRcdHRoaXMub2Zmc2V0WCA9IDA7XHJcblx0XHR0aGlzLm9mZnNldFkgPSAwO1xyXG5cdFx0dGhpcy5jbGVhblJlY3QgPSBudWxsO1xyXG5cclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgd29ya2VyQ291bnQ7ICsraSkge1xyXG5cdFx0XHRsZXQgd29ya2VyID0gbmV3IFdvcmtlcignLi9zY3JpcHRzL2RyYXdfd29ya2VyLmpzJyk7XHJcblx0XHRcdGxldCBwaXhlbHMgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoY2h1bmtXaWR0aCAqIGNodW5rSGVpZ2h0ICogNCk7XHJcblx0XHRcdC8vLyBDYXB0dXJlIGluZGV4XHJcblx0XHRcdCgod29ya2VyOiBXb3JrZXIsIHZpZXc6IFByb2NlZHVyYWxJbWFnZVZpZXcsIGluZGV4OiBudW1iZXIpID0+IHtcclxuXHRcdFx0XHR3b3JrZXIub25tZXNzYWdlID0gKG1zZzogTWVzc2FnZUV2ZW50PERyYXdSZWdpb25NZXNzYWdlPikgPT4ge1xyXG5cdFx0XHRcdFx0bGV0IHBpeGVscyA9IG5ldyBVaW50OENsYW1wZWRBcnJheShtc2cuZGF0YS5waXhlbHMpO1xyXG5cdFx0XHRcdFx0aWYgKG1zZy5kYXRhLmxpbWl0ID09IHZpZXcubGltaXRcclxuXHRcdFx0XHRcdFx0JiYgbXNnLmRhdGEudmlld3BvcnQud2lkdGggPT0gdmlldy52aWV3cG9ydC53aWR0aFxyXG5cdFx0XHRcdFx0XHQmJiBtc2cuZGF0YS52aWV3cG9ydC5oZWlnaHQgPT0gdmlldy52aWV3cG9ydC5oZWlnaHRcclxuXHRcdFx0XHRcdCkge1xyXG5cdFx0XHRcdFx0XHRsZXQgaW1hZ2UgPSBuZXcgSW1hZ2VEYXRhKHBpeGVscywgbXNnLmRhdGEud2lkdGgsIG1zZy5kYXRhLmhlaWdodCk7XHJcblx0XHRcdFx0XHRcdHZpZXcuY29udGV4dC5wdXRJbWFnZURhdGEoXHJcblx0XHRcdFx0XHRcdFx0aW1hZ2UsXHJcblx0XHRcdFx0XHRcdFx0bXNnLmRhdGEucGl4ZWxYICsgdmlldy5vZmZzZXRYIC0gbXNnLmRhdGEub2Zmc2V0WCxcclxuXHRcdFx0XHRcdFx0XHRtc2cuZGF0YS5waXhlbFkgKyB2aWV3Lm9mZnNldFkgLSBtc2cuZGF0YS5vZmZzZXRZKTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRsZXQgd29yayA9IHZpZXcud29yay5wb3AoKTtcclxuXHRcdFx0XHRcdGlmICh3b3JrICE9IG51bGwpIHtcclxuXHRcdFx0XHRcdFx0d29yay5waXhlbHMgPSBwaXhlbHMuYnVmZmVyO1xyXG5cdFx0XHRcdFx0XHR3b3JrZXIucG9zdE1lc3NhZ2Uod29yaywgW3dvcmsucGl4ZWxzXSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR2aWV3LmZyZWVXb3JrZXJzLnB1c2goW3dvcmtlciwgcGl4ZWxzXSk7XHJcblx0XHRcdFx0XHRcdHZpZXcuY2xlYW5SZWN0ID0gdmlldy52aWV3cG9ydDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9KSh3b3JrZXIsIHRoaXMsIGkpO1xyXG5cdFx0XHR0aGlzLmZyZWVXb3JrZXJzLnB1c2goW3dvcmtlciwgcGl4ZWxzXSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKiogVXBkYXRlIHBhcnQgb2YgdGhlIHZpZXdlZCBpbWFnZS5cclxuXHQgKiBAcGFyYW0ge251bWJlcn0gbGltaXQgTWF4aW11bSBudW1iZXIgb2YgaXRlcmF0aW9ucyB0byB1c2Ugd2hlbiBkcmF3aW5nIHRoZSBpbWFnZS4gXHJcblx0ICogQHBhcmFtIHtET01SZWN0fSByZWN0IFRoZSByZWdpb24gb2YgdGhlIGltYWdlIHRvIHJlZHJhdyAoaW4gcGl4ZWxzKS4gRGVmYXVsdHMgdG8gdGhlIHdob2xlIGltYWdlIGlmIG51bGwuXHJcblx0ICovXHJcblx0dXBkYXRlKGxpbWl0OiBudW1iZXIsIHJlY3Q/OiBET01SZWN0KSB7XHJcblx0XHRpZiAodGhpcy5saW1pdCAhPSBsaW1pdCB8fCByZWN0ID09IG51bGwpIHtcclxuXHRcdFx0dGhpcy5jbGVhcldvcmsoKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZWN0ID0gcmVjdCB8fCBuZXcgRE9NUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcclxuXHRcdHRoaXMubGltaXQgPSBsaW1pdDtcclxuXHJcblx0XHRsZXQgY2h1bmtzWCA9IHJlY3Qud2lkdGggLyB0aGlzLmNodW5rV2lkdGgsXHJcblx0XHRcdGNodW5rc1kgPSByZWN0LmhlaWdodCAvIHRoaXMuY2h1bmtIZWlnaHQ7XHJcblxyXG5cdFx0aWYgKHRoaXMuY2xlYXJTdHlsZSAhPSBudWxsKSB7XHJcblx0XHRcdHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSB0aGlzLmNsZWFyU3R5bGU7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgcmVjdFcgPSB0aGlzLmNodW5rV2lkdGggLyB0aGlzLmNhbnZhcy53aWR0aCAqIHRoaXMudmlld3BvcnQud2lkdGg7XHJcblx0XHRjb25zdCByZWN0SCA9IHRoaXMuY2h1bmtIZWlnaHQgLyB0aGlzLmNhbnZhcy5oZWlnaHQgKiB0aGlzLnZpZXdwb3J0LmhlaWdodDtcclxuXHJcblx0XHQvLyB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ2dyZWVuJztcclxuXHRcdGZvciAodmFyIHkgPSAwOyB5IDwgY2h1bmtzWTsgKyt5KSB7XHJcblx0XHRcdGNvbnN0IHBpeGVsWSA9IHJlY3QueSArIHkgKiB0aGlzLmNodW5rSGVpZ2h0O1xyXG5cdFx0XHRjb25zdCByZWN0WSA9IHRoaXMudmlld3BvcnQueSArIChyZWN0LnkgKyB5ICogdGhpcy5jaHVua0hlaWdodCkgLyB0aGlzLmNhbnZhcy5oZWlnaHQgKiB0aGlzLnZpZXdwb3J0LmhlaWdodDtcclxuXHJcblx0XHRcdGZvciAodmFyIHggPSAwOyB4IDwgY2h1bmtzWDsgKyt4KSB7XHJcblx0XHRcdFx0Y29uc3QgcGl4ZWxYID0gcmVjdC54ICsgeCAqIHRoaXMuY2h1bmtXaWR0aDtcclxuXHRcdFx0XHRjb25zdCByZWN0WCA9IHRoaXMudmlld3BvcnQueCArIChyZWN0LnggKyB4ICogdGhpcy5jaHVua1dpZHRoKSAvIHRoaXMuY2FudmFzLndpZHRoICogdGhpcy52aWV3cG9ydC53aWR0aDtcclxuXHJcblx0XHRcdFx0Ly8gdGhpcy5jb250ZXh0LmZpbGxSZWN0KHBpeGVsWCwgcGl4ZWxZLCB0aGlzLmNodW5rV2lkdGgsIHRoaXMuY2h1bmtIZWlnaHQpO1xyXG5cdFx0XHRcdHRoaXMucXVldWVXb3JrKHtcclxuXHRcdFx0XHRcdHBpeGVsczogUExBQ0VIT0xERVJfQlVGRkVSLFxyXG5cdFx0XHRcdFx0d2lkdGg6IHRoaXMuY2h1bmtXaWR0aCxcclxuXHRcdFx0XHRcdGhlaWdodDogdGhpcy5jaHVua0hlaWdodCxcclxuXHRcdFx0XHRcdHJlY3Q6IG5ldyBET01SZWN0KHJlY3RYLCByZWN0WSwgcmVjdFcsIHJlY3RIKSxcclxuXHRcdFx0XHRcdGxpbWl0OiBsaW1pdCxcclxuXHRcdFx0XHRcdHBpeGVsWDogcGl4ZWxYLFxyXG5cdFx0XHRcdFx0cGl4ZWxZOiBwaXhlbFksXHJcblx0XHRcdFx0XHR2aWV3cG9ydDogRE9NUmVjdC5mcm9tUmVjdCh0aGlzLnZpZXdwb3J0KSxcclxuXHRcdFx0XHRcdG9mZnNldFg6IHRoaXMub2Zmc2V0WCxcclxuXHRcdFx0XHRcdG9mZnNldFk6IHRoaXMub2Zmc2V0WVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy53b3JrLnJldmVyc2UoKTtcclxuXHR9XHJcblxyXG5cdC8qKiBSZXNldCB0aGUgdmlld3BvcnQgdG8gZGVmYXVsdCBzdGF0ZSBhbmQgcmVkcmF3IHRoZSBpbWFnZSB3aXRoIHByb3ZpZGVkIGxpbWl0LlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBsaW1pdCBNYXhpbXVtIG51bWJlciBvZiBpdGVyYXRpb25zIHRvIHVzZSB3aGVuIGRyYXdpbmcgdGhlIGltYWdlLlxyXG5cdCAqL1xyXG5cdHJlc2V0KGxpbWl0OiBudW1iZXIpIHtcclxuXHRcdHRoaXMuY2xlYXJXb3JrKCk7XHJcblx0XHRpZiAodGhpcy5jYW52YXMud2lkdGggPj0gdGhpcy5jYW52YXMuaGVpZ2h0KSB7XHJcblx0XHRcdGxldCByYXRpbyA9IHRoaXMuY2FudmFzLndpZHRoIC8gdGhpcy5jYW52YXMuaGVpZ2h0O1xyXG5cdFx0XHR0aGlzLnZpZXdwb3J0ID0gbmV3IERPTVJlY3QoLXJhdGlvLCAtMSwgMipyYXRpbywgMik7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRsZXQgcmF0aW8gPSB0aGlzLmNhbnZhcy5oZWlnaHQgLyB0aGlzLmNhbnZhcy5oZWlnaHQ7XHJcblx0XHRcdHRoaXMudmlld3BvcnQgPSBuZXcgRE9NUmVjdCgtMSwgLXJhdGlvLCAyLCAyKnJhdGlvKTtcclxuXHRcdH1cclxuXHRcdHRoaXMudXBkYXRlKGxpbWl0KTtcclxuXHR9XHJcblxyXG5cdC8qKiBTaGlmdCB0aGVlIGltYWdlIHByb3ZpZGVkIG51bWJlciBvZiBwaXhlbHMuXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHggSG9yaXpvbnRhbCBudW1iZXIgb2YgcGl4ZWxzIHRvIHNoaWZ0IHRoZSBpbWFnZSBieS5cclxuXHQgKiBAcGFyYW0ge251bWJlcn0geSBWZXJ0aWNhbCBudW1iZXIgb2YgcGl4ZWxzIHRvIHNoaWZ0IHRoZSBpbWFnZSBieS5cclxuXHQgKi9cclxuXHRwYW4oeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuXHRcdHRoaXMuY2xlYXJXb3JrKCk7XHJcblxyXG5cdFx0bGV0IG1pZFggPSB4ID49IDAgPyB4IDogdGhpcy5jYW52YXMud2lkdGggKyB4LFxyXG5cdFx0XHRtaWRZID0geSA+PSAwID8geSA6IHRoaXMuY2FudmFzLmhlaWdodCArIHksXHJcblx0XHRcdHF1YWRyYW50czogRE9NUmVjdFtdID0gW107XHJcblx0XHRcclxuXHRcdHRoaXMudmlld3BvcnQueCAtPSB4IC8gdGhpcy5jYW52YXMud2lkdGggKiB0aGlzLnZpZXdwb3J0LndpZHRoO1xyXG5cdFx0dGhpcy52aWV3cG9ydC55IC09IHkgLyB0aGlzLmNhbnZhcy5oZWlnaHQgKiB0aGlzLnZpZXdwb3J0LmhlaWdodDtcclxuXHJcblx0XHR0aGlzLm9mZnNldFggKz0geDtcclxuXHRcdHRoaXMub2Zmc2V0WSArPSB5O1xyXG5cclxuXHRcdHF1YWRyYW50cyA9IFtcclxuXHRcdFx0bmV3IERPTVJlY3QoMCwgMCwgbWlkWCwgbWlkWSksXHJcblx0XHRcdG5ldyBET01SZWN0KG1pZFgsIDAsIHRoaXMuY2FudmFzLndpZHRoIC0gbWlkWCwgbWlkWSksXHJcblx0XHRcdG5ldyBET01SZWN0KDAsIG1pZFksIG1pZFgsIHRoaXMuY2FudmFzLmhlaWdodCAtIG1pZFkpLFxyXG5cdFx0XHRuZXcgRE9NUmVjdChtaWRYLCBtaWRZLCB0aGlzLmNhbnZhcy53aWR0aCAtIG1pZFgsIHRoaXMuY2FudmFzLmhlaWdodCAtIG1pZFkpLFxyXG5cdFx0XTtcclxuXHJcblx0XHQvLyBSZW1vdmUgdGhlIGNsZWFuIHF1YWRyYW50LlxyXG5cdFx0aWYgKHggPCAwICYmIHkgPCAwKSB7XHJcblx0XHRcdGxldCBpbWFnZURhdGEgPSB0aGlzLmNvbnRleHQuZ2V0SW1hZ2VEYXRhKC14LCAteSwgcXVhZHJhbnRzWzBdLndpZHRoLCBxdWFkcmFudHNbMF0uaGVpZ2h0KTtcclxuXHRcdFx0dGhpcy5jb250ZXh0LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xyXG5cdFx0fSBlbHNlIGlmICh4ID49IDAgJiYgeSA8IDApIHtcclxuXHRcdFx0bGV0IGltYWdlRGF0YSA9IHRoaXMuY29udGV4dC5nZXRJbWFnZURhdGEoMCwgLXksIHF1YWRyYW50c1sxXS53aWR0aCwgcXVhZHJhbnRzWzFdLmhlaWdodCk7XHJcblx0XHRcdHRoaXMuY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCB4LCAwKTtcclxuXHRcdH0gZWxzZSBpZiAoeCA8IDAgJiYgeSA+PSAwKSB7XHJcblx0XHRcdGxldCBpbWFnZURhdGEgPSB0aGlzLmNvbnRleHQuZ2V0SW1hZ2VEYXRhKC14LCAwLCBxdWFkcmFudHNbMl0ud2lkdGgsIHF1YWRyYW50c1syXS5oZWlnaHQpO1xyXG5cdFx0XHR0aGlzLmNvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgeSk7XHJcblx0XHR9IGVsc2UgaWYgKHggPj0gMCAmJiB5ID49IDApIHtcclxuXHRcdFx0bGV0IGltYWdlRGF0YSA9IHRoaXMuY29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgcXVhZHJhbnRzWzNdLndpZHRoLCBxdWFkcmFudHNbM10uaGVpZ2h0KTtcclxuXHRcdFx0dGhpcy5jb250ZXh0LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIHgsIHkpO1xyXG5cdFx0fVxyXG5cdFxyXG5cdFx0dGhpcy51cGRhdGUodGhpcy5saW1pdCk7XHJcblx0fVxyXG5cclxuXHQvKiogWm9vbSB0aGUgaW1hZ2UgaW4gb3Igb3V0IGFyb3VuZCBhIHByb3ZpZGVkIHBvaW50LlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4IFRoZSBob3Jpem9udGFsIGluZGV4IG9mIHRoZSBwaXhlbCBhcm91bmQgd2hpY2ggdG8gem9vbS5cclxuXHQgKiBAcGFyYW0ge251bWJlcn0geSBUaGUgdmVydGljYWwgaW5kZXggb2YgdGhlIHBpeGVsIGFyb3VuZCB3aGljaCB0byB6b29tLlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBzY2FsZSBUaGUgcmF0aW8gYnkgaG93IG11Y2ggdG8gem9vbSB0aGUgcGljdHVyZS5cclxuXHQgKi9cclxuXHR6b29tKHg6IG51bWJlciwgeTogbnVtYmVyLCBzY2FsZTogbnVtYmVyKSB7XHJcblx0XHR0aGlzLmNsZWFyV29yaygpO1xyXG5cclxuXHRcdGxldCByZWxYID0geCAvIHRoaXMuY2FudmFzLndpZHRoLFxyXG5cdFx0XHRyZWxZID0geSAvIHRoaXMuY2FudmFzLmhlaWdodCxcclxuXHRcdFx0cG9pbnRYID0gdGhpcy52aWV3cG9ydC54ICsgdGhpcy52aWV3cG9ydC53aWR0aCAqIHJlbFgsXHJcblx0XHRcdHBvaW50WSA9IHRoaXMudmlld3BvcnQueSArIHRoaXMudmlld3BvcnQuaGVpZ2h0ICogcmVsWTtcclxuXHRcdFxyXG5cdFx0dGhpcy52aWV3cG9ydC53aWR0aCAqPSBzY2FsZTtcclxuXHRcdHRoaXMudmlld3BvcnQuaGVpZ2h0ICo9IHNjYWxlO1xyXG5cdFx0dGhpcy52aWV3cG9ydC54ID0gcG9pbnRYIC0gdGhpcy52aWV3cG9ydC53aWR0aCAqIHJlbFg7XHJcblx0XHR0aGlzLnZpZXdwb3J0LnkgPSBwb2ludFkgLSB0aGlzLnZpZXdwb3J0LmhlaWdodCAqIHJlbFk7XHJcblxyXG5cdFx0Ly8gUmV1c2UgdGhlIGV4aXN0ZW50IGltYWdlIHdoaWxlIHRoZSB3b3JrZXJzIGFyZSByZWRyYXdpbmcgaXQuXHJcblx0XHRpZiAoc2NhbGUgPiAxKSB7XHJcblx0XHRcdGxldCBpbnZTY2FsZSA9IDEgLyBzY2FsZTtcclxuXHRcdFx0dGhpcy5jb250ZXh0LmRyYXdJbWFnZShcclxuXHRcdFx0XHR0aGlzLmNhbnZhcyxcclxuXHRcdFx0XHR0aGlzLmNhbnZhcy53aWR0aCAqIHJlbFggLSB0aGlzLmNhbnZhcy53aWR0aCAqIHJlbFggKiBpbnZTY2FsZSxcclxuXHRcdFx0XHR0aGlzLmNhbnZhcy5oZWlnaHQgKiByZWxZIC0gdGhpcy5jYW52YXMuaGVpZ2h0ICogcmVsWSAqIGludlNjYWxlLFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLndpZHRoICogaW52U2NhbGUsXHJcblx0XHRcdFx0dGhpcy5jYW52YXMuaGVpZ2h0ICogaW52U2NhbGUpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5jb250ZXh0LmRyYXdJbWFnZShcclxuXHRcdFx0XHR0aGlzLmNhbnZhcyxcclxuXHRcdFx0XHR0aGlzLmNhbnZhcy53aWR0aCAqIHJlbFggLSB0aGlzLmNhbnZhcy53aWR0aCAqIHJlbFggKiBzY2FsZSxcclxuXHRcdFx0XHR0aGlzLmNhbnZhcy5oZWlnaHQgKiByZWxZIC0gdGhpcy5jYW52YXMuaGVpZ2h0ICogcmVsWSAqIHNjYWxlLFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLndpZHRoICogc2NhbGUsXHJcblx0XHRcdFx0dGhpcy5jYW52YXMuaGVpZ2h0ICogc2NhbGUsXHJcblx0XHRcdFx0MCxcclxuXHRcdFx0XHQwLFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLndpZHRoLFxyXG5cdFx0XHRcdHRoaXMuY2FudmFzLmhlaWdodCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy51cGRhdGUodGhpcy5saW1pdCk7XHJcblx0fVxyXG5cclxuXHQvKiogUmVzaXplIHRoZSB2aWV3LlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aCBUaGUgbmV3IHdpZHRoIG9mIHRoZSB2aWV3IGluIHBpeGVscy5cclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaGVpZ2h0IFRoZSBuZXcgaGVpZ2h0IG9mIHRoZSB2aWV3IGluIHBpeGVscy5cclxuXHQgKi9cclxuXHRyZXNpemUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIHtcclxuXHRcdHRoaXMuY2xlYXJXb3JrKCk7XHJcblx0XHR0aGlzLnZpZXdwb3J0LndpZHRoICo9IHdpZHRoIC8gdGhpcy5jYW52YXMud2lkdGg7XHJcblx0XHR0aGlzLnZpZXdwb3J0LmhlaWdodCAqPSBoZWlnaHQgLyB0aGlzLmNhbnZhcy5oZWlnaHQ7XHJcblx0XHR0aGlzLmNhbnZhcy53aWR0aCA9IHdpZHRoO1xyXG5cdFx0dGhpcy5jYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG5cdFx0dGhpcy51cGRhdGUodGhpcy5saW1pdCk7XHJcblx0fVxyXG5cclxuXHQvKiogQ2xlYXIgYW55IHF1ZXVlZCB3b3JrICovXHJcblx0cHJpdmF0ZSBjbGVhcldvcmsoKSB7XHJcblx0XHR0aGlzLndvcmsubGVuZ3RoID0gMDtcclxuXHR9XHJcblxyXG5cdC8qKiBRdWV1ZSBhIHBpZWNlIG9mIHdvcmsgdG8gYmUgZG9uZS4gKi9cclxuXHRwcml2YXRlIHF1ZXVlV29yayh3b3JrOiBEcmF3UmVnaW9uTWVzc2FnZSkge1xyXG5cdFx0bGV0IGZyZWUgPSB0aGlzLmZyZWVXb3JrZXJzLnBvcCgpO1xyXG5cdFx0aWYgKGZyZWUgIT0gbnVsbCkge1xyXG5cdFx0XHR3b3JrLnBpeGVscyA9IGZyZWVbMV0uYnVmZmVyO1xyXG5cdFx0XHRmcmVlWzBdLnBvc3RNZXNzYWdlKHdvcmssIFt3b3JrLnBpeGVsc10pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy53b3JrLnB1c2god29yayk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsImltcG9ydCB7IFByb2NlZHVyYWxJbWFnZVZpZXcgfSBmcm9tIFwiLi9Qcm9jZWR1cmFsSW1hZ2VWaWV3XCI7XHJcblxyXG4vLyBDb25zdGFudHNcclxuXHJcbmNvbnN0IFdIRUVMX1NFTlNJVElWSVRZID0gMWUtMztcclxuXHJcbi8vIEdsb2JhbCB2YXJpYWJsZXNcclxuXHJcbmxldCBsYWJlbFggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29vcmQteCcpIGFzIEhUTUxFbGVtZW50LFxyXG5cdGxhYmVsWSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb29yZC15JykgYXMgSFRNTEVsZW1lbnQsXHJcblx0bW91c2VYID0gMCwgbW91c2VZID0gMCxcclxuXHRlbmFibGVQYW4gPSBmYWxzZTtcclxuXHJcbi8vIEZyZWUgZnVuY3Rpb24gZGVjbGFyYXRpb25zXHJcblxyXG4vKiogU2V0IHRoZSBjb29yZGluYXRlcyB0byBkaXNwbGF5IHByb3ZpZGVkIHZhbHVlcy5cclxuICogQHBhcmFtIHtudW1iZXJ9IHggVGhlIGhvcml6b250YWwgY29vcmRpbmF0ZSB0byBkaXNwbGF5LlxyXG4gKiBAcGFyYW0ge251bWJlcn0geSBUaGUgdmVydGljYWwgY29vcmRpbmF0ZSB0byBkaXNwbGF5LlxyXG4gKi9cclxuZnVuY3Rpb24gZGlzcGxheUNvb3JkaW5hdGVzKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XHJcblx0bGFiZWxYLnRleHRDb250ZW50ID0gYFg6ICR7eC50b0V4cG9uZW50aWFsKDMpfWA7XHJcblx0bGFiZWxZLnRleHRDb250ZW50ID0gYFk6ICR7eS50b0V4cG9uZW50aWFsKDMpfWA7XHJcbn1cclxuXHJcbmxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJykgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG5jYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xyXG5sZXQgdmlldyA9IG5ldyBQcm9jZWR1cmFsSW1hZ2VWaWV3KGNhbnZhcyk7XHJcblxyXG4vLyBSZWdpc3RlciBldmVudHNcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB2aWV3LnJlc2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KSk7XHJcblxyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCBldmVudCA9PiB7XHJcblx0ZW5hYmxlUGFuID0gdHJ1ZTtcclxuXHRtb3VzZVggPSBldmVudC5jbGllbnRYO1xyXG5cdG1vdXNlWSA9IGV2ZW50LmNsaWVudFk7XHJcbn0pO1xyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBldmVudCA9PiB7XHJcblx0aWYgKGVuYWJsZVBhbikge1xyXG5cdFx0dmlldy5wYW4oTWF0aC5yb3VuZChldmVudC5jbGllbnRYIC0gbW91c2VYKSwgTWF0aC5yb3VuZChldmVudC5jbGllbnRZIC0gbW91c2VZKSk7XHJcblx0XHRtb3VzZVggPSBldmVudC5jbGllbnRYO1xyXG5cdFx0bW91c2VZID0gZXZlbnQuY2xpZW50WTtcclxuXHR9XHJcbn0pO1xyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgKCkgPT4gZW5hYmxlUGFuID0gZmFsc2UpO1xyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmxlYXZlJywgKCkgPT4gZW5hYmxlUGFuID0gZmFsc2UpO1xyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmNhbmNlbCcsICgpID0+IGVuYWJsZVBhbiA9IGZhbHNlKTtcclxuXHJcbmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIGV2ZW50ID0+IHtcclxuXHR2aWV3Lnpvb20oZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSwgMSArIGV2ZW50LmRlbHRhWSAqIFdIRUVMX1NFTlNJVElWSVRZKTtcdFxyXG59KTtcclxuLy8gVE9ETzogaGFuZGxlIHRvdWNoKiBldmVudHNcclxuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2dlc3R1cmVjaGFuZ2UnLCAoZXZlbnQ6IGFueSkgPT4ge1xyXG5cdHZpZXcuem9vbShldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZLCBldmVudC5zY2FsZSk7XHJcbn0pO1xyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignZ2VzdHVyZWVuZCcsIChldmVudDogYW55KSA9PiB7XHJcblx0dmlldy56b29tKGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFksIGV2ZW50LnNjYWxlKTtcclxufSk7XHJcblxyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgZXZlbnQgPT4ge1xyXG5cdGRpc3BsYXlDb29yZGluYXRlcyhcclxuXHRcdHZpZXcudmlld3BvcnQueCArIGV2ZW50LmNsaWVudFggLyBjYW52YXMud2lkdGggKiB2aWV3LnZpZXdwb3J0LndpZHRoLFxyXG5cdFx0dmlldy52aWV3cG9ydC55ICsgZXZlbnQuY2xpZW50WSAvIGNhbnZhcy5oZWlnaHQgKiB2aWV3LnZpZXdwb3J0LmhlaWdodCk7XHJcbn0pO1xyXG5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcclxuXHRkaXNwbGF5Q29vcmRpbmF0ZXMoXHJcblx0XHR2aWV3LnZpZXdwb3J0LnggKyB2aWV3LnZpZXdwb3J0LndpZHRoKi41LFxyXG5cdFx0dmlldy52aWV3cG9ydC55ICsgdmlldy52aWV3cG9ydC5oZWlnaHQqLjUpO1xyXG59KTtcclxuXHJcbnZpZXcucmVzaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xyXG5cclxuZGlzcGxheUNvb3JkaW5hdGVzKFxyXG5cdHZpZXcudmlld3BvcnQueCArIHZpZXcudmlld3BvcnQud2lkdGgqLjUsXHJcblx0dmlldy52aWV3cG9ydC55ICsgdmlldy52aWV3cG9ydC5oZWlnaHQqLjUpO1xyXG5cclxuZXhwb3J0IHsgdmlldyB9O1xyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiaW1wb3J0IHsgdmlldyB9IGZyb20gXCIuL2NhbnZhc1wiO1xyXG5cclxuLy8gR2xvYmFsIHZhcmlhYmxlc1xyXG5cclxubGV0IGxpbWl0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbWl0JykgYXMgSFRNTElucHV0RWxlbWVudCxcclxuXHRyZWRyYXdUaW1lciA9IDAsXHJcblx0ZHJhd25MaW1pdCA9IE51bWJlcihsaW1pdC52YWx1ZSk7XHJcblxyXG4vLyBGcmVlIGZ1bmN0aW9uc1xyXG5cclxuLyoqIFJlZHJhdyB0aGUgcGljdHVyZSBpbW1lZGlhdGVseSBhbmQgY2FuY2VsIGFueSBwZW5kaW5nIHJlZHJhd3MuXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBsaW1pdCBUaGUgbGltaXQgdG8gdXNlIHdoZW4gcmVkcmF3aW5nLlxyXG4gKi9cclxuZnVuY3Rpb24gcmVkcmF3SW1tZWRpYXRlbHkobGltaXQ6IG51bWJlcik6IHZvaWQge1xyXG5cdGlmIChsaW1pdCAhPT0gZHJhd25MaW1pdCkge1xyXG5cdFx0dmlldy51cGRhdGUobGltaXQpO1xyXG5cdFx0ZHJhd25MaW1pdCA9IGxpbWl0O1xyXG5cdH1cclxufVxyXG5cclxuLy8gUmVnaXN0ZXIgZXZlbnQgbGlzdGVuZXJzXHJcblxyXG5saW1pdC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuXHRsZXQgdmFsdWUgPSBOdW1iZXIobGltaXQudmFsdWUpLFxyXG5cdFx0bWluID0gTnVtYmVyKGxpbWl0Lm1pbiksXHJcblx0XHRtYXggPSBOdW1iZXIobGltaXQubWF4KTtcclxuXHJcblx0aWYgKHZhbHVlIDwgbWluKSB7XHJcblx0XHR2YWx1ZSA9IG1pbjtcclxuXHR9IGVsc2UgaWYgKHZhbHVlID4gbWF4KSB7XHJcblx0XHR2YWx1ZSA9IG1heDtcclxuXHR9XHJcblxyXG5cdGlmICh2YWx1ZSA+PSBtaW4gJiYgdmFsdWUgPD0gbWF4KSB7XHJcblx0XHRyZWRyYXdJbW1lZGlhdGVseSh2YWx1ZSk7XHJcblx0fVxyXG59KTtcclxubGltaXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xyXG5cdGxldCB2YWx1ZSA9IDAsXHJcblx0bWluID0gTnVtYmVyKGxpbWl0Lm1pbiksXHJcblx0bWF4ID0gTnVtYmVyKGxpbWl0Lm1heCk7XHJcblx0XHJcblx0Ly8gVmFsaWRhdGUgaW5wdXRcclxuXHRpZiAobGltaXQudmFsdWUgPT09ICcnKSB7XHJcblx0XHRsaW1pdC52YWx1ZSA9ICczMCc7XHJcblx0fVxyXG5cdFxyXG5cdHZhbHVlID0gTnVtYmVyKGxpbWl0LnZhbHVlKTtcclxuXHJcblx0aWYgKHZhbHVlIDwgbWluKSB7XHJcblx0XHRsaW1pdC52YWx1ZSA9IGxpbWl0Lm1pbjtcclxuXHR9IGVsc2UgaWYgKHZhbHVlID4gbWF4KSB7XHJcblx0XHRsaW1pdC52YWx1ZSA9IGxpbWl0Lm1heDtcclxuXHR9XHJcblxyXG5cdHJlZHJhd0ltbWVkaWF0ZWx5KE51bWJlcihsaW1pdC52YWx1ZSkpO1xyXG59KTtcclxuIiwiaW1wb3J0IHsgdmlldyB9IGZyb20gXCIuL2NhbnZhc1wiO1xyXG5cclxuLy8gQ29uc3RhbnRzXHJcblxyXG5jb25zdCBNRU5VX1dJRFRIID0gMjQwO1xyXG5jb25zdCBUT0dHTEVfQlVUVE9OX01BUkdJTiA9IDIwO1xyXG5cclxuLy8gR2xvYmFsIHZhcmlhYmxlc1xyXG5cclxubGV0IGxpbWl0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbWl0JykgYXMgSFRNTElucHV0RWxlbWVudCxcclxuXHRzaWRlTWVudSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaWRlLW1lbnUnKSEsXHJcblx0dG9nZ2xlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1tZW51JykhLFxyXG5cdGFycm93ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZS1tZW51LWFycm93JykhO1xyXG5cclxuLy8gRnJlZSBmdW5jdGlvbnNcclxuXHJcbi8qKiBPcGVuIHRoZSBzaWRlIG1lbnUgb2YgdGhlIGRvY3VtZW50LiAqL1xyXG5mdW5jdGlvbiBvcGVuU2lkZU1lbnUoKSB7XHJcblx0dmFyIHNpZGVNZW51V2lkdGggPSAwO1xyXG5cclxuXHRzaWRlTWVudS5zdHlsZS53aWR0aCA9IGAke01FTlVfV0lEVEh9cHRgO1xyXG5cdHNpZGVNZW51V2lkdGggPSBzaWRlTWVudS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDtcclxuXHR0b2dnbGVCdXR0b24uc3R5bGUubWFyZ2luUmlnaHQgPSBgJHtNRU5VX1dJRFRIICsgVE9HR0xFX0JVVFRPTl9NQVJHSU59cHRgO1xyXG5cdGFycm93LmNsYXNzTGlzdC5yZW1vdmUoJ2xlZnQnKTtcclxuXHRhcnJvdy5jbGFzc0xpc3QuYWRkKCdyaWdodCcpO1xyXG59XHJcblxyXG4vKiogQ2xvc2UgdGhlIHNpZGUgbWVudSBvZiB0aGUgZG9jdW1lbnQuICovXHJcbmZ1bmN0aW9uIGNsb3NlU2lkZU1lbnUoKSB7XHJcblx0c2lkZU1lbnUuc3R5bGUud2lkdGggPSAnMCc7XHJcblx0dG9nZ2xlQnV0dG9uLnN0eWxlLm1hcmdpblJpZ2h0ID0gYCR7VE9HR0xFX0JVVFRPTl9NQVJHSU59cHRgO1xyXG5cdGFycm93LmNsYXNzTGlzdC5yZW1vdmUoJ3JpZ2h0Jyk7XHJcblx0YXJyb3cuY2xhc3NMaXN0LmFkZCgnbGVmdCcpO1xyXG59XHJcblxyXG4vKiogT3BlbiB0aGUgc2lkZSBtZW51IG9mIHRoZSBkb2N1bWVudCBpZiBpdCdzIGNsb3NlZCBvciBjbG9zZSBpdCBpZiBpdCdzIG9wZW4uICovXHJcbmZ1bmN0aW9uIHRvZ2dsZVNpZGVNZW51KCkge1xyXG5cdGlmIChzaWRlTWVudS5zdHlsZS53aWR0aCA9PT0gYCR7TUVOVV9XSURUSH1wdGApIHtcclxuXHRcdGNsb3NlU2lkZU1lbnUoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0b3BlblNpZGVNZW51KCk7XHJcblx0fVxyXG59XHJcblxyXG4vLyBSZWdpc3RlciBldmVudHNcclxuXHJcbnRvZ2dsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVNpZGVNZW51KTtcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZHJhdycpIS5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdHZpZXcudXBkYXRlKE51bWJlcihsaW1pdC52YWx1ZSkpO1xyXG59XHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXNldCcpIS5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdHZpZXcucmVzZXQoTnVtYmVyKGxpbWl0LnZhbHVlKSk7XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==